import{_ as M,U as N,r as i,aD as U,A as z,g as n,o as f,l as p,w as o,f as a,h,c as I,i as _,aE as J,aF as T,am as s,aH as V}from"./index-CBERRbij.js";const j=["src"],q={__name:"offlineAssessmentCreation",props:{visibleOfflineAssessment:{type:Boolean,required:!1}},emits:["create","update:visibleOfflineAssessment"],setup(g,{emit:P}){const u=P,b=g,{visibleOfflineAssessment:k}=N(b),C=i("/prod-api/order/common/up-photo"),y={Authorization:"Bearer "+U()},l=i(!1),r=i(!1),A=i(),t=z({contentPhoto:{}}),x={},O=(e,m)=>{l.value=!1,e.code===200&&e.data?(t.contentPhoto=e.data,s.success("上传成功")):s.error(e.msg||"上传失败")},B=e=>{l.value=!0;const m=e.type==="image/jpeg"||e.type==="image/png",c=e.size/1024/1024<10;return m?c?!0:(l.value=!1,s.error("上传图片大小不能超过 10MB!"),!1):(l.value=!1,s.error("上传图片只能是 JPG 或 PNG 格式!"),!1)},d=()=>{t.contentPhoto={},r.value=!1,u("update:visibleOfflineAssessment",!1)},w=()=>{if(!t.contentPhoto){s.error("请上传行驶证照片");return}r.value=!0,V(t.contentPhoto).then(e=>{e.code===200?(s.success("创建成功"),d(),u("create")):(s.error(e.msg),r.value=!1,u("create"))}).catch(e=>{s.error(e.msg||"创建失败"),r.value=!1})};return(e,m)=>{const c=n("el-icon"),R=n("el-upload"),E=n("el-form-item"),G=n("el-form"),v=n("el-button"),L=n("el-dialog");return f(),p(L,{"model-value":_(k),title:"线下定损建单",width:"520px",onClose:d},{footer:o(()=>[a(v,{onClick:d},{default:o(()=>[h("取消")]),_:1}),a(v,{type:"primary",loading:r.value,onClick:w},{default:o(()=>[h("创建")]),_:1},8,["loading"])]),default:o(()=>[a(G,{model:t,rules:x,ref_key:"formRef",ref:A,"label-width":"100px"},{default:o(()=>[a(E,{label:"行驶证照片",prop:"contentPhoto"},{default:o(()=>[a(R,{class:"cover-uploader",action:C.value,headers:y,"show-file-list":!1,"on-success":O,"before-upload":B},{default:o(()=>[t.contentPhoto&&t.contentPhoto.photoOriginal?(f(),I("img",{key:0,src:t.contentPhoto.photoOriginal,class:"cover-image"},null,8,j)):l.value?(f(),p(c,{key:2,class:"cover-uploader-icon is-loading"},{default:o(()=>[a(_(T))]),_:1})):(f(),p(c,{key:1,class:"cover-uploader-icon"},{default:o(()=>[a(_(J))]),_:1}))]),_:1},8,["action"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value"])}}},F=M(q,[["__scopeId","data-v-809e789d"]]);export{F as default};
