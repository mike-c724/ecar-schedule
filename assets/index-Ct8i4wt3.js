import{a as X,r as i,g as s,R as Y,o as p,c as C,f as a,w as t,F,C as S,i as P,l as N,h as v,S as T,x as Z,T as ee,z as ae,t as le}from"./index-Bz8aCySx.js";import{l as te,m as oe,g as se}from"./parts-BYIs77_x.js";const ne={class:"app-container parts"},re=ae({name:"Parts"}),me=Object.assign(re,{setup(ue){X();const{proxy:k}=le(),w=k.useDict("part_parts","covers_points","structure_points","interior_points","electromechanical_points"),{part_parts:x}=w,R=(u,l)=>{var n;return l?(n=u[l])==null?void 0:n.value:[]},c=i({pageNum:1,pageSize:10,partsName:"",partParts:"",status:""}),r=i({partsName:"",partParts:"",status:""}),z=u=>{c.value={pageNum:1,pageSize:10,...u},y()},B=()=>{r.value={partsName:"",partParts:"",status:""},z(r.value)},E=()=>{V.value="add",f.value=!0},h=i(!1),$=i([]),D=i(0),j=u=>{V.value="edit",f.value=!0,o.value={...u}},f=i(!1),V=i("add"),U=i(null),o=i({partsName:"",partParts:"",partsPosition:"",status:""}),A={partsName:[{required:!0,message:"请输入零部件名称",trigger:"blur"}],partParts:[{required:!0,message:"请选择所属部位",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},I=()=>{o.value.partsPosition=""},O=()=>{o.value={partsName:"",partParts:"",partsPosition:"",status:""},U.value.resetFields()},Q=()=>{f.value=!1},G=async u=>{if(!await u.validate(n=>!!n))return!1;k.$modal.loading();try{V.value==="add"?await te(o.value):await oe(o.value),await y(),f.value=!1}catch(n){console.error("验证或请求失败:",n)}finally{k.$modal.closeLoading()}},y=()=>{h.value=!0,se(c.value).then(u=>{const{rows:l,total:n}=u;$.value=l,D.value=n}).finally(()=>{h.value=!1})};return y(),(u,l)=>{const n=s("el-input"),d=s("el-form-item"),m=s("el-option"),b=s("el-select"),g=s("el-button"),q=s("el-form"),_=s("el-table-column"),L=s("dict-tag"),H=s("el-tag"),J=s("el-table"),K=s("pagination"),M=s("el-dialog"),W=Y("loading");return p(),C("div",ne,[a(q,{model:r.value,inline:!0},{default:t(()=>[a(d,{label:"零部件名称"},{default:t(()=>[a(n,{modelValue:r.value.partsName,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value.partsName=e),placeholder:"请输入零部件名称",clearable:"",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),a(d,{label:"所属部位"},{default:t(()=>[a(b,{modelValue:r.value.partParts,"onUpdate:modelValue":l[1]||(l[1]=e=>r.value.partParts=e),placeholder:"请选择所属部位",style:{width:"240px"},clearable:""},{default:t(()=>[(p(!0),C(F,null,S(P(x),e=>(p(),N(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"状态"},{default:t(()=>[a(b,{modelValue:r.value.status,"onUpdate:modelValue":l[2]||(l[2]=e=>r.value.status=e),placeholder:"请选择状态",style:{width:"240px"},clearable:""},{default:t(()=>[a(m,{label:"启用",value:"0"}),a(m,{label:"禁用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),a(d,null,{default:t(()=>[a(g,{type:"primary",icon:"Search",onClick:l[3]||(l[3]=e=>z(r.value))},{default:t(()=>[v("查询")]),_:1}),a(g,{icon:"Refresh",onClick:B},{default:t(()=>[v("重置")]),_:1}),a(g,{type:"primary",icon:"Plus",onClick:E},{default:t(()=>[v("新增")]),_:1})]),_:1})]),_:1},8,["model"]),T((p(),N(J,{data:$.value},{default:t(()=>[a(_,{type:"index",label:"序号",width:"50",align:"center"}),a(_,{label:"零部件名称",prop:"partsName",align:"center"}),a(_,{label:"所属部位",prop:"partParts",align:"center"},{default:t(({row:e})=>[a(L,{options:P(x),value:e.partParts},null,8,["options","value"])]),_:1}),a(_,{label:"所属点位",prop:"partsPosition",align:"center"},{default:t(({row:e})=>[a(L,{options:R(P(w),e.partParts),value:e.partsPosition},null,8,["options","value"])]),_:1}),a(_,{label:"状态",prop:"status",align:"center"},{default:t(({row:e})=>[a(H,{type:e.status==="0"?"primary":"danger"},{default:t(()=>[v(Z(e.status==="0"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),a(_,{label:"操作"},{default:t(({row:e})=>[a(g,{type:"primary",text:"",onClick:ie=>j(e)},{default:t(()=>[v("修改")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[W,h.value]]),T(a(K,{total:D.value,page:c.value.pageNum,"onUpdate:page":l[4]||(l[4]=e=>c.value.pageNum=e),limit:c.value.pageSize,"onUpdate:limit":l[5]||(l[5]=e=>c.value.pageSize=e),onPagination:y},null,8,["total","page","limit"]),[[ee,D.value>0]]),a(M,{title:V.value==="add"?"新增零部件":"编辑零部件",modelValue:f.value,"onUpdate:modelValue":l[11]||(l[11]=e=>f.value=e),width:"500","close-on-click-modal":!1,onClose:O},{footer:t(()=>[a(g,{onClick:Q},{default:t(()=>[v("取 消")]),_:1}),a(g,{type:"primary",onClick:l[10]||(l[10]=e=>G(U.value))},{default:t(()=>[v("确 定")]),_:1})]),default:t(()=>[a(q,{model:o.value,ref_key:"dialogFormRef",ref:U,rules:A,"label-width":"100px"},{default:t(()=>[a(d,{label:"零部件名称",prop:"partsName"},{default:t(()=>[a(n,{modelValue:o.value.partsName,"onUpdate:modelValue":l[6]||(l[6]=e=>o.value.partsName=e),placeholder:"请输入零部件名称",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{label:"所属部位",prop:"partParts"},{default:t(()=>[a(b,{modelValue:o.value.partParts,"onUpdate:modelValue":l[7]||(l[7]=e=>o.value.partParts=e),onChange:I,placeholder:"请选择所属部位",clearable:""},{default:t(()=>[(p(!0),C(F,null,S(P(x),e=>(p(),N(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"所属点位",prop:"partsPosition"},{default:t(()=>[a(b,{modelValue:o.value.partsPosition,"onUpdate:modelValue":l[8]||(l[8]=e=>o.value.partsPosition=e),placeholder:"请选择所属点位",clearable:""},{default:t(()=>[(p(!0),C(F,null,S(R(P(w),o.value.partParts),e=>(p(),N(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"状态",prop:"status"},{default:t(()=>[a(b,{modelValue:o.value.status,"onUpdate:modelValue":l[9]||(l[9]=e=>o.value.status=e),placeholder:"请选择状态",clearable:""},{default:t(()=>[a(m,{label:"启用",value:"0"}),a(m,{label:"禁用",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}});export{me as default};
