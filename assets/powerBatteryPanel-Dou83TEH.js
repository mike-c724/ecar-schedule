import{e as ge}from"./empty-X662_Asi.js";import{E as C,F as q,i as me,G as ve}from"./useOrderInfo-oTm2EOs0.js";import{S as be,a as _e}from"./swiper-vue-Cu1ZKMQW.js";import{g as ye}from"./ratingSetting-U-JgFuAd.js";import"./swiper-LA7WfxAj.js";/* empty css                   *//* empty css                   */import{_ as Ve,u as Se,a as he,A as we,r as w,v as Me,b as Ce,d as ke,g as m,o as n,c as d,f as l,w as a,h as M,e as V,x as k,F as i,l as c,i as p,C as g,aJ as Ue,m as R,aK as Le,t as Ae,E as Ie,am as xe,p as De,q as Ee}from"./index-Bz8aCySx.js";import{d as Te}from"./toBeEvaluated-Bo3_wRio.js";const U=L=>(De("data-v-148e2fe0"),L=L(),Ee(),L),$e={class:"battery-panel"},Re={class:"brand-text"},Be={class:"photo-swiper-box"},Oe={class:"photo-slide"},Pe={class:"photo-info"},Ne=["src","alt","onClick"],Fe={key:1,class:"photo-empty"},He=U(()=>V("span",null,"km",-1)),qe=U(()=>V("span",null,"次",-1)),ze=U(()=>V("span",null,"次",-1)),je=U(()=>V("span",null,"km",-1)),Ge=U(()=>V("span",null,"V",-1)),Je={class:"box gap-2"},Ke={class:"score-range"},We={__name:"powerBatteryPanel",setup(L,{expose:z}){const{proxy:j}=Ae(),{sys_yes_no:Ye,fault_level:S,battery_grade:G,energy_type:J}=j.useDict("sys_yes_no","fault_level","battery_grade","energy_type"),B=Se(),K=he(),r=we({pictureInfoList:[],brand:"",powerBatteryDataSource:"",displayMileage:"",rateMileage:"",batteryCapacityScore:"",temperatureAccordScore:"",voltageAccordScore:"",irAccordScore:"",isolationScore:"",batteryHealthVal:"",totalChargeSoc:"",isPowerType:!0,powerType:"",numberOfDeepCharges:"",numberOfDaysUsed:"",fullEndurance:"",powerManage:"",dcdcManage:"",batteryThermalManage:"",voltConsistManage:"",motorThermalManage:"",voltManage:"",insulateManage:"",otherManage:"",batterySingleVoltage:"",averageStartSoc:"",averageEndSoc:"",batteryLevel1AlarmDict:"",batteryLevel2AlarmDict:"",batteryLevel3AlarmDict:"",batteryLevel:"",batteryMaintenanceMsg:""}),W={rateMileage:[{pattern:/^\d+$/,message:"请输入数字",trigger:"blur"}],batteryCapacityScore:[{pattern:/^(100(\.00)?|([1-9][0-9]?)(\.[0-9]{2})?|0\.(0[1-9]|[1-9][0-9]))$/,message:"必须大于0且小于等于100，支持两位小数",trigger:["blur","change"]}],temperatureAccordScore:[{pattern:/^(100(\.00)?|([1-9][0-9]?)(\.[0-9]{2})?|0\.(0[1-9]|[1-9][0-9]))$/,message:"必须大于0且小于等于100，支持两位小数",trigger:["blur","change"]}],voltageAccordScore:[{pattern:/^(100(\.00)?|([1-9][0-9]?)(\.[0-9]{2})?|0\.(0[1-9]|[1-9][0-9]))$/,message:"必须大于0且小于等于100，支持两位小数",trigger:["blur","change"]}],irAccordScore:[{pattern:/^(100(\.00)?|([1-9][0-9]?)(\.[0-9]{2})?|0\.(0[1-9]|[1-9][0-9]))$/,message:"必须大于0且小于等于100，支持两位小数",trigger:["blur","change"]}],isolationScore:[{pattern:/^(100(\.00)?|([1-9][0-9]?)(\.[0-9]{2})?|0\.(0[1-9]|[1-9][0-9]))$/,message:"必须大于0且小于等于100，支持两位小数",trigger:["blur","change"]}],batteryHealthVal:[{pattern:/^(100(\.00)?|([1-9][0-9]?)(\.[0-9]{2})?|0\.(0[1-9]|[1-9][0-9]))$/,message:"必须大于0且小于等于100，支持两位小数",trigger:["blur","change"]}],totalChargeSoc:[{pattern:/^\d+$/,message:"请输入整数",trigger:["blur","change"]}],numberOfDeepCharges:[{pattern:/^\d+$/,message:"请输入整数",trigger:["blur","change"]}],batteryMaintenanceMsg:[{required:!0,message:"请输入电池养护建议",trigger:"blur"},{max:200,message:"最多200个字符",trigger:"blur"}],batterySingleVoltage:[],averageStartSoc:[{pattern:/^-?\d+$/,message:"请输入整数",trigger:"blur"}],averageEndSoc:[{pattern:/^-?\d+$/,message:"请输入整数",trigger:"blur"}]},Y=async()=>{Object.keys(C.value).forEach(u=>{C.value[u]!==null&&(r[u]=C.value[u])})},Q=u=>{const t=J.value.find(o=>o.value===u);return t?t.label:""},O=w(),X=u=>{console.log("item",u),r.batteryMaintenanceMsg=u.remark},P=async(u=!1)=>{C.value=r,await Z();let t={...C.value,orderId:me.value};const o=await ve(t);return u&&o&&K.push({path:`/evaluationManagement/conclusion/view/${B.params.id}`}),!0},Z=async()=>(console.log("validateForm"),new Promise((u,t)=>{O.value.validate(o=>{o?u(o):(Ie.alert("请填写所有必填项后再进行其他操作！","提示"),t(new Error("表单验证失败")))})})),I=w(!1),x=w(0),ee=Me(()=>r.pictureInfoList.map(u=>u.pictureUrl)),le=u=>{x.value=u,I.value=!0},D=w(null),E=w(null),ae=()=>{D.value&&r.pictureInfoList.length>1&&E.value.slidePrev()},te=()=>{D.value&&r.pictureInfoList.length>1&&E.value.slideNext()},re=u=>{E.value=u},oe=u=>{x.value=u.activeIndex},N=w([]),ne=async()=>{const u=await ye({conclusionType:"5"});console.log("res",u),N.value=u.data||[]},A=w(""),h=w("loading"),v=w(null),ue={0:"loading",1:"success",2:"fail",3:"no_record"},se=()=>{if(!A.value){xe.warning("暂无维保记录");return}const u=A.value;window.open(u,"mozillaWindow","width=800,height=500,top=100,left=200,scrollbars=yes")},de=()=>{v.value&&clearInterval(v.value),v.value=setInterval(async()=>{const u=B.params.id,{data:t}=await Te(u);if(!t){h.value="no_record",A.value="",v.value&&(clearInterval(v.value),v.value=null);return}h.value=ue[t.status]||"no_record",A.value=t.che300ReportUrl||"",(h.value==="success"||h.value==="fail")&&v.value&&(clearInterval(v.value),v.value=null)},5e3)};return Ce(async()=>{await ne(),C.value&&Y(),de()}),ke(()=>{v.value&&(clearInterval(v.value),v.value=null)}),z({handleCheckConclusion:P}),(u,t)=>{const o=m("el-col"),F=m("el-button"),b=m("el-row"),H=m("el-icon"),pe=m("el-empty"),ie=m("el-image-viewer"),f=m("el-input"),s=m("el-form-item"),T=m("el-card"),_=m("el-option"),y=m("el-select"),ce=m("el-tag"),fe=m("el-form");return n(),d("div",$e,[l(fe,{ref_key:"formRef",ref:O,model:r,rules:W,"label-width":"140px",size:"normal",disabled:p(q)==7,class:"battery-form"},{default:a(()=>[l(T,{shadow:"never",class:"mb16"},{header:a(()=>[l(b,null,{default:a(()=>[l(o,{span:20,class:"card-title"},{default:a(()=>[M(" 车辆基础信息 "),V("span",Re," 车型信息： "+k(r.brand)+", 能源类型："+k(Q(r.powerType)),1)]),_:1}),l(o,{span:4,class:"tr"},{default:a(()=>[l(F,{type:h.value==="loading"?"info":h.value==="success"?"primary":h.value==="fail"?"danger":"default",onClick:se},{default:a(()=>[h.value==="loading"?(n(),d(i,{key:0},[M(" 维保报告查询中 ")],64)):h.value==="success"?(n(),d(i,{key:1},[M(" 查看维保报告 ")],64)):h.value==="fail"?(n(),d(i,{key:2},[M(" 维保报告查询失败 ")],64)):(n(),d(i,{key:3},[M(" 无维保报告 ")],64))]),_:1},8,["type"])]),_:1})]),_:1})]),default:a(()=>[l(b,{gutter:20},{default:a(()=>[l(o,{span:14},{default:a(()=>[V("div",Be,[r.pictureInfoList&&r.pictureInfoList.length?(n(),c(p(be),{key:0,ref_key:"batterySwiper",ref:D,"slides-per-view":1,navigation:!1,pagination:{clickable:!0},class:"battery-photo-swiper",onSwiper:re,onSlideChange:oe},{default:a(()=>[(n(!0),d(i,null,g(r.pictureInfoList,(e,$)=>(n(),c(p(_e),{key:$},{default:a(()=>[V("div",Oe,[V("div",Pe,k(e.pictureInfo),1),V("img",{class:"photo-img",src:e.pictureUrl,alt:e.pictureInfo,onClick:Qe=>le($)},null,8,Ne),r.pictureInfoList.length>1?(n(),c(H,{key:0,class:"arrow left",onClick:ae},{default:a(()=>[l(p(Ue))]),_:1})):R("",!0),r.pictureInfoList.length>1?(n(),c(H,{key:1,class:"arrow right",onClick:te},{default:a(()=>[l(p(Le))]),_:1})):R("",!0)])]),_:2},1024))),128))]),_:1},512)):(n(),d("div",Fe,[l(pe,{description:" 暂无照片",image:p(ge)},null,8,["image"])])),I.value?(n(),c(ie,{key:2,"url-list":ee.value,"initial-index":x.value,onClose:t[0]||(t[0]=e=>I.value=!1)},null,8,["url-list","initial-index"])):R("",!0)])]),_:1}),l(o,{span:10},{default:a(()=>[l(b,{gutter:20},{default:a(()=>[l(o,null,{default:a(()=>[l(s,{label:"表显行驶里程",prop:"displayMileage"},{default:a(()=>[l(f,{modelValue:r.displayMileage,"onUpdate:modelValue":t[1]||(t[1]=e=>r.displayMileage=e),modelModifiers:{number:!0},disabled:p(q)!=3,placeholder:"请输入"},{suffix:a(()=>[He]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),l(b,{gutter:20},{default:a(()=>[l(o,null,{default:a(()=>[l(s,{label:"充电循环次数",prop:"totalChargeSoc"},{default:a(()=>[l(f,{modelValue:r.totalChargeSoc,"onUpdate:modelValue":t[2]||(t[2]=e=>r.totalChargeSoc=e),placeholder:"请输入"},{suffix:a(()=>[qe]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(b,{gutter:20},{default:a(()=>[l(o,null,{default:a(()=>[l(s,{label:"深度充电次数",prop:"numberOfDeepCharges"},{default:a(()=>[l(f,{modelValue:r.numberOfDeepCharges,"onUpdate:modelValue":t[3]||(t[3]=e=>r.numberOfDeepCharges=e),placeholder:"请输入"},{suffix:a(()=>[ze]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(T,{shadow:"never",class:"mb16"},{header:a(()=>[M("自动计算 ")]),default:a(()=>[l(b,{gutter:20},{default:a(()=>[l(o,{span:4},{default:a(()=>[l(s,{label:"容量得分",prop:"batteryCapacityScore"},{default:a(()=>[l(f,{modelValue:r.batteryCapacityScore,"onUpdate:modelValue":t[4]||(t[4]=e=>r.batteryCapacityScore=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"当前满电续航",prop:"fullEndurance"},{default:a(()=>[l(f,{modelValue:r.fullEndurance,"onUpdate:modelValue":t[5]||(t[5]=e=>r.fullEndurance=e),placeholder:"请输入",suffix:"km"},{suffix:a(()=>[je]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"温度一致性得分",prop:"temperatureAccordScore"},{default:a(()=>[l(f,{modelValue:r.temperatureAccordScore,"onUpdate:modelValue":t[6]||(t[6]=e=>r.temperatureAccordScore=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"电压一致性得分",prop:"voltageAccordScore"},{default:a(()=>[l(f,{modelValue:r.voltageAccordScore,"onUpdate:modelValue":t[7]||(t[7]=e=>r.voltageAccordScore=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"内阻一致性得分",prop:"irAccordScore"},{default:a(()=>[l(f,{modelValue:r.irAccordScore,"onUpdate:modelValue":t[8]||(t[8]=e=>r.irAccordScore=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"自放电率得分",prop:"isolationScore"},{default:a(()=>[l(f,{modelValue:r.isolationScore,"onUpdate:modelValue":t[9]||(t[9]=e=>r.isolationScore=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(b,{gutter:20},{default:a(()=>[l(o,{span:4},{default:a(()=>[l(s,{label:"电池健康得分",prop:"batteryHealthVal"},{default:a(()=>[l(f,{modelValue:r.batteryHealthVal,"onUpdate:modelValue":t[10]||(t[10]=e=>r.batteryHealthVal=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(T,{shadow:"never",class:"mb16"},{header:a(()=>[M("预估数值 ")]),default:a(()=>[l(b,{gutter:20},{default:a(()=>[l(o,{span:4},{default:a(()=>[l(s,{label:"电芯单体电压",prop:"batterySingleVoltage"},{default:a(()=>[l(f,{modelValue:r.batterySingleVoltage,"onUpdate:modelValue":t[11]||(t[11]=e=>r.batterySingleVoltage=e),placeholder:"3.2-3.8之间"},{suffix:a(()=>[Ge]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"平均起始SOC",prop:"averageStartSoc"},{default:a(()=>[l(f,{modelValue:r.averageStartSoc,"onUpdate:modelValue":t[12]||(t[12]=e=>r.averageStartSoc=e),placeholder:"20-40之间"},null,8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"平均充电终止SOC",prop:"averageEndSoc"},{default:a(()=>[l(f,{modelValue:r.averageEndSoc,"onUpdate:modelValue":t[13]||(t[13]=e=>r.averageEndSoc=e),placeholder:"80-100之间"},null,8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"一级故障水平",prop:"batteryLevel1AlarmDict"},{default:a(()=>[l(y,{clearable:"",modelValue:r.batteryLevel1AlarmDict,"onUpdate:modelValue":t[14]||(t[14]=e=>r.batteryLevel1AlarmDict=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"二级故障水平",prop:"batteryLevel2AlarmDict"},{default:a(()=>[l(y,{clearable:"",modelValue:r.batteryLevel2AlarmDict,"onUpdate:modelValue":t[15]||(t[15]=e=>r.batteryLevel2AlarmDict=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(b,{gutter:20},{default:a(()=>[l(o,{span:4},{default:a(()=>[l(s,{label:"三级故障水平",prop:"batteryLevel3AlarmDict"},{default:a(()=>[l(y,{clearable:"",modelValue:r.batteryLevel3AlarmDict,"onUpdate:modelValue":t[16]||(t[16]=e=>r.batteryLevel3AlarmDict=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"电量管理水平",prop:"powerManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.powerManage,"onUpdate:modelValue":t[17]||(t[17]=e=>r.powerManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"DC-DC管理水平",prop:"dcdcManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.dcdcManage,"onUpdate:modelValue":t[18]||(t[18]=e=>r.dcdcManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"热管理水平",prop:"batteryThermalManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.batteryThermalManage,"onUpdate:modelValue":t[19]||(t[19]=e=>r.batteryThermalManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"电压一致性管理水平",prop:"voltConsistManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.voltConsistManage,"onUpdate:modelValue":t[20]||(t[20]=e=>r.voltConsistManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"电机热管理水平",prop:"motorThermalManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.motorThermalManage,"onUpdate:modelValue":t[21]||(t[21]=e=>r.motorThermalManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(b,{gutter:20},{default:a(()=>[l(o,{span:4},{default:a(()=>[l(s,{label:"电压热管理水平",prop:"voltManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.voltManage,"onUpdate:modelValue":t[22]||(t[22]=e=>r.voltManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"绝缘热管理水平",prop:"insulateManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.insulateManage,"onUpdate:modelValue":t[23]||(t[23]=e=>r.insulateManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"其他管理水平",prop:"otherManage"},{default:a(()=>[l(y,{clearable:"",modelValue:r.otherManage,"onUpdate:modelValue":t[24]||(t[24]=e=>r.otherManage=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(S),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(o,{span:4},{default:a(()=>[l(s,{label:"电池综合评级",prop:"batteryLevel"},{default:a(()=>[l(y,{clearable:"",modelValue:r.batteryLevel,"onUpdate:modelValue":t[25]||(t[25]=e=>r.batteryLevel=e),placeholder:"请选择"},{default:a(()=>[(n(!0),d(i,null,g(p(G),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(b,{gutter:20},{default:a(()=>[l(o,{span:24},{default:a(()=>[V("div",Je,[(n(!0),d(i,null,g(N.value,e=>(n(),c(ce,{key:e.id,onClick:$=>X(e)},{default:a(()=>[M(k(e.conclusionScoreLabel),1),V("span",Ke,"("+k(e.conclusionScoreValue)+")",1)]),_:2},1032,["onClick"]))),128))]),l(s,{label:"电池养护建议",prop:"batteryMaintenanceMsg"},{default:a(()=>[l(f,{type:"textarea",rows:3,modelValue:r.batteryMaintenanceMsg,"onUpdate:modelValue":t[26]||(t[26]=e=>r.batteryMaintenanceMsg=e),maxlength:"200","show-word-limit":"",placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","disabled"]),l(b,null,{default:a(()=>[l(o,{span:24,class:"tr"},{default:a(()=>[l(F,{type:"primary",onClick:t[27]||(t[27]=e=>P(!0))},{default:a(()=>[M("查看结论")]),_:1})]),_:1})]),_:1})])}}},ul=Ve(We,[["__scopeId","data-v-148e2fe0"]]);export{ul as default};
