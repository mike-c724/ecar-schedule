import{_ as fe,v as x,r as o,A as pe,g as m,o as _e,c as ge,f as e,w as l,h as O,e as d,H as he,n as ke,a2 as Z,i,as as Ce,at as we,au as Ve,av as Ie,aw as xe,ax as Re}from"./index-CBERRbij.js";import{e as be}from"./empty-CNFjmX0R.js";const ye={class:"verification-container"},Me={class:"image-preview-area"},Se=["src"],Pe={class:"image-controls"},De={class:"iconBox"},Le={class:"edit-area"},R=.5,b=3,y=.2,Ue={__name:"verification",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","confirm"],setup(A,{expose:H,emit:j}){const M=Ce,S=we,P=Ve,D=Ie,q=xe,F=Re,G=A,_=j,C=x({get:()=>G.modelValue,set:t=>{_("update:modelValue",t)}}),r=o({}),J=o(null),w=o(null),K=o(null),Q=o(null),c=o(1),v=o(0),g=o(0),h=o(0),L=o(0),U=o(0),$=o(0),z=o(0),f=o(!1),s=pe({vin:"",licensePlate:"",failedMessage:""});H({openDialog:t=>{var n,a,p;r.value=t||{},s.vin=((n=r.value)==null?void 0:n.vin)||"",s.licensePlate=((a=r.value)==null?void 0:a.licensePlate)||"",s.failedMessage=((p=r.value)==null?void 0:p.failedMessage)||"",V(),C.value=!0}});const ee=x(()=>({transform:`translate(${g.value}px, ${h.value}px)`})),ae=x(()=>({transform:`scale(${c.value}) rotate(${v.value}deg)`,transition:f.value?"none":"transform 0.2s ease"})),le=()=>{V()},te=t=>{t.preventDefault();const n=t.deltaY>0?-.2:y,a=c.value+n;a>=R&&a<=b&&(c.value=a)},oe=()=>{c.value<b&&(c.value=Math.min(c.value+y,b))},ne=()=>{c.value>R&&(c.value=Math.max(c.value-y,R))},se=()=>{v.value=(v.value-90)%360},ie=()=>{v.value=(v.value+90)%360},ce=t=>{f.value=!0,L.value=t.clientX,U.value=t.clientY,$.value=g.value,z.value=h.value,document.addEventListener("mousemove",Y),document.addEventListener("mouseup",T),t.preventDefault()},Y=t=>{if(!f.value)return;const n=t.clientX-L.value,a=t.clientY-U.value;g.value=$.value+n,h.value=z.value+a},T=()=>{f.value=!1,document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",T)},V=()=>{c.value=1,v.value=0,g.value=0,h.value=0},re=()=>{w.value&&w.value.showPreview()},X=()=>{_("update:modelValue",!1)},ue=()=>{const t={...r.value,vin:s.vin,licensePlate:s.licensePlate,failedMessage:s.failedMessage};_("confirm",t),_("update:modelValue",!1)};return(t,n)=>{const a=m("el-icon"),p=m("el-input"),B=m("el-form-item"),de=m("el-form"),me=m("el-image"),E=m("el-button"),ve=m("el-dialog");return _e(),ge("div",null,[e(ve,{modelValue:C.value,"onUpdate:modelValue":n[2]||(n[2]=k=>C.value=k),title:"核对信息",width:"500px","close-on-click-modal":!1,onClose:X},{footer:l(()=>[e(E,{onClick:X},{default:l(()=>[O("取消")]),_:1}),e(E,{type:"primary",onClick:ue},{default:l(()=>[O("确定")]),_:1})]),default:l(()=>{var k,N,W;return[d("div",ye,[d("div",Me,[d("div",{class:he(["imageWrapper",{dragging:f.value}]),ref_key:"imageWrapperRef",ref:K,onWheel:ke(te,["prevent"])},[d("div",{class:"imageTransformContainer",style:Z(ee.value)},[d("img",{ref_key:"mainImageRef",ref:Q,src:((k=r.value)==null?void 0:k.photoUrl)||i(be),class:"mainImage",style:Z(ae.value),onMousedown:ce,onLoad:le},null,44,Se)],4)],34),d("div",Pe,[d("div",De,[e(a,{onClick:ne,title:"缩小"},{default:l(()=>[e(i(S))]),_:1}),e(a,{onClick:oe,title:"放大"},{default:l(()=>[e(i(M))]),_:1}),e(a,{onClick:se,title:"逆时针旋转"},{default:l(()=>[e(i(P))]),_:1}),e(a,{onClick:ie,title:"顺时针旋转"},{default:l(()=>[e(i(D))]),_:1}),e(a,{onClick:V,title:"重置"},{default:l(()=>[e(i(F))]),_:1}),e(a,{onClick:re,title:"全屏预览"},{default:l(()=>[e(i(q))]),_:1})])])]),d("div",Le,[e(de,{ref_key:"formRef",ref:J,model:s,"label-width":"70px"},{default:l(()=>[e(B,{label:"VIN码",prop:"vin"},{default:l(()=>[e(p,{modelValue:s.vin,"onUpdate:modelValue":n[0]||(n[0]=u=>s.vin=u),placeholder:"请输入VIN码",maxlength:"17","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1}),e(B,{label:"车牌号",prop:"licensePlate"},{default:l(()=>[e(p,{modelValue:s.licensePlate,"onUpdate:modelValue":n[1]||(n[1]=u=>s.licensePlate=u),placeholder:"请输入车牌号",maxlength:"8","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),e(me,{ref_key:"imageRef",ref:w,src:(N=r.value)==null?void 0:N.photoUrl,class:"fullscreen-image","preview-src-list":(W=r.value)!=null&&W.photoUrl?[r.value.photoUrl]:[],fit:"cover","hide-on-click-modal":""},{toolbar:l(({actions:u,prev:ze,next:Ye,reset:Te,activeIndex:Xe})=>[e(a,{onClick:I=>u("zoomOut")},{default:l(()=>[e(i(S))]),_:2},1032,["onClick"]),e(a,{onClick:I=>u("zoomIn",{enableTransition:!1,zoomRate:2})},{default:l(()=>[e(i(M))]),_:2},1032,["onClick"]),e(a,{onClick:I=>u("clockwise",{rotateDeg:180,enableTransition:!1})},{default:l(()=>[e(i(D))]),_:2},1032,["onClick"]),e(a,{onClick:I=>u("anticlockwise")},{default:l(()=>[e(i(P))]),_:2},1032,["onClick"])]),_:1},8,["src","preview-src-list"])]}),_:1},8,["modelValue"])])}}},Ne=fe(Ue,[["__scopeId","data-v-425fca91"]]);export{Ne as default};
