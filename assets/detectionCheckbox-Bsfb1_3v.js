import{P as k,_ as W,r as m,a0 as q,b as X,g as i,R as Y,o as r,c as b,e as R,f as n,i as _,B as N,k as Z,w as o,h as w,S as ee,F as $,C as B,l as E,x as te,m as ae,z as ne,t as oe}from"./index-CBERRbij.js";function ve(s){const{detectionProtocolsId:l,version:d,vehicleStructure:c}=s;let p="";return d?p=`/product/evaluation-plan/evaluation-info/${l}/${c}/${d}`:p=`/product/evaluation-plan/evaluation-info/${l}/${c}`,k({url:p,method:"get"})}function me(s){const{evaluationPlanId:l,version:d}=s;let c=`/product/evaluation-plan/evaluation-parts/${l}`;return k({url:c,method:"get"})}function _e(s){return k({url:"/product/evaluation-plan/add-plan",method:"post",data:s})}function he(s){return k({url:"/product/evaluation-plan/edit-plan",method:"put",data:s})}function se(s){const{vehicleStructure:l,detectionType:d,version:c}=s;let p;return c?p=`/product/assessment/list-by-detectionTypeAndVehicleStructure/${l}/${d}/${c}`:p=`/product/assessment/list-by-detectionTypeAndVehicleStructure/${l}/${d}`,k({url:p,method:"get"})}const le={class:"detection-checkbox-search"},ce={class:"detection-checkbox"},ue={class:"list"},ie=ne({name:"DetectionCheckbox"}),re=Object.assign(ie,{props:{data:{type:Object,required:!0,default:()=>({})},checkValue:{type:Array,required:!0,default:()=>[]},vehicleStructure:{type:String,required:!0}},emits:["update:checkValue","update:data"],setup(s,{emit:l}){const{proxy:d}=oe(),{shooting_configuration:c,detection_type:p}=d.useDict("shooting_configuration","detection_type"),C=s,j=l,y=m([]),h=m([]),x=m([]),A=m(!1),V=m(""),f=m(""),I=m([]),O=()=>{if(!f.value.trim()){y.value=I.value;return}y.value=I.value.filter(e=>e.assessmentName.toLowerCase().includes(f.value.toLowerCase()))},U=()=>{f.value="",P()},z=()=>{let e=[];h.value.forEach(t=>{t.assessmentEvaluationCriteriaIdList&&t.assessmentEvaluationCriteriaIdList.length>0&&(e=e.concat(t.assessmentEvaluationCriteriaIdList))}),x.value=e};q(()=>C.checkValue,e=>{h.value=e,z()},{immediate:!0,deep:!0}),q(()=>C.data.shootingConfiguration,e=>{e&&(V.value=e)},{immediate:!0,deep:!0});const F=e=>{j("update:data",{...C.data,shootingConfiguration:e})},P=()=>{A.value=!0;const{detectionType:e}=C.data;se({detectionType:e,vehicleStructure:C.vehicleStructure}).then(t=>{I.value=t.data||[],y.value=I.value}).finally(()=>{A.value=!1})},K=(e,t)=>{const{evaluationCriteriaList:T,detectionType:S,productAssessmentId:v}=t,L=T.filter(u=>e.includes(u.assessmentEvaluationCriteriaId)).map(u=>u.assessmentEvaluationCriteriaId),D=h.value.findIndex(u=>u.productAssessmentId===v);D===-1?h.value.push({detectionType:S,productAssessmentId:v,assessmentEvaluationCriteriaIdList:L}):h.value[D].assessmentEvaluationCriteriaIdList=L,j("update:checkValue",h.value)};return X(()=>{P()}),(e,t)=>{const T=i("el-input"),S=i("el-button"),v=i("el-col"),L=i("el-checkbox"),D=i("el-checkbox-group"),u=i("el-row"),M=i("el-empty"),G=i("el-option"),H=i("el-select"),J=Y("loading");return r(),b($,null,[R("div",le,[n(T,{"prefix-icon":"Search",class:"search-input",modelValue:_(f),"onUpdate:modelValue":t[0]||(t[0]=a=>N(f)?f.value=a:null),placeholder:"请输入检测项名称",clearable:"",onKeydown:Z(O,["enter"])},null,8,["modelValue"]),n(S,{type:"primary",onClick:O},{default:o(()=>[w("搜索")]),_:1}),n(S,{onClick:U},{default:o(()=>[w("重置")]),_:1})]),ee((r(),b("div",ce,[R("div",ue,[(r(!0),b($,null,B(_(y),a=>(r(),E(u,{class:"rows",key:a.productAssessmentId},{default:o(()=>[n(v,{class:"title",span:6},{default:o(()=>[w(te(a.assessmentName),1)]),_:2},1024),n(v,{class:"content",span:18},{default:o(()=>[n(D,{modelValue:_(x),"onUpdate:modelValue":t[1]||(t[1]=g=>N(x)?x.value=g:null),onChange:g=>K(g,a)},{default:o(()=>[(r(!0),b($,null,B(a.evaluationCriteriaList,(g,Q)=>(r(),E(L,{key:Q,label:g.damageDescription,value:g.assessmentEvaluationCriteriaId},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onChange"])]),_:2},1024)]),_:2},1024))),128)),_(y).length===0?(r(),E(u,{key:0,class:"rows"},{default:o(()=>[n(v,{class:"title",span:24},{default:o(()=>[n(M,{description:"暂无数据"})]),_:1})]),_:1})):ae("",!0)]),n(u,{class:"rows pad-top"},{default:o(()=>[n(v,{span:6},{default:o(()=>[w(" 拍摄配置 ")]),_:1}),n(v,{span:18},{default:o(()=>[n(H,{clearable:"",modelValue:_(V),"onUpdate:modelValue":t[2]||(t[2]=a=>N(V)?V.value=a:null),onChange:F,placeholder:"请选择拍摄配置"},{default:o(()=>[(r(!0),b($,null,B(_(c),a=>(r(),E(G,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])),[[J,_(A)]])],64)}}}),de=W(re,[["__scopeId","data-v-e6e7cecd"]]),fe=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));export{me as a,_e as b,fe as c,de as d,he as e,ve as g};
