import{g as j,e as I,a as O,t as G}from"./ratingSetting-ByAh_3Af.js";import{_ as H,r as m,b as J,g as u,o as k,c as T,e as w,f as l,w as o,h as r,x as V,F as P,C as Q,D as C,am as f,E as W}from"./index-CBERRbij.js";const X={class:"app-container"},Y={class:"headerBox"},Z={class:"tableBox"},ee={__name:"index",setup(le){const S=[{label:"整车评级",value:1},{label:"动力电池",value:2},{label:"风险度等级",value:3},{label:"风险类型",value:4},{label:"电池养护建议",value:5}],x=m([]),d=m(!1),g=m("新增评级配置"),n=m(b()),c=m(),v=m(!1),L={conclusionType:[{required:!0,message:"请选择结论类型",trigger:["blur","change"]}],conclusionScoreKey:[{required:!0,message:"请输入结论等级",trigger:"blur"}],conclusionScoreValue:[{required:!0,message:"请输入结论等级描述",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},h=t=>{var e;return((e=S.find(s=>s.value===t))==null?void 0:e.label)||t};function b(){return{conclusionType:"",conclusionScoreKey:"",conclusionScoreValue:"",remark:"",conclusionScoreLabel:"",status:"1"}}const y=async()=>{const t=await j();t&&t.code===200&&(x.value=Array.isArray(t.data)?t.data:[])},q=()=>{g.value="新增评级配置",n.value=b(),C(()=>{var t;return(t=c.value)==null?void 0:t.clearValidate()}),d.value=!0},D=t=>{g.value="编辑评级配置",Object.assign(n.value,b(),t),C(()=>{var e;return(e=c.value)==null?void 0:e.clearValidate()}),d.value=!0},U=async()=>{c.value&&(v.value=!0,c.value.validate(async t=>{var e;if(!t){v.value=!1;return}try{let s;(e=n.value)!=null&&e.id?s=await I({...n.value}):s=await O(n.value),s&&s.code===200?(f.success("保存成功"),d.value=!1,y()):f.error((s==null?void 0:s.msg)||"操作失败")}finally{v.value=!1}}))},B=t=>{W.confirm(`确定要${t.status==="0"?"禁用":"启用"}该配置吗？`,"提示",{type:"warning"}).then(async()=>{const e=await G(t.id,t.status==="1"?"0":"1");e&&e.code===200?(f.success(`${t.status==="0"?"禁用":"启用"}成功`),y()):f.error((e==null?void 0:e.msg)||"操作失败")})},F=()=>{c.value&&c.value.resetFields()};return J(y),(t,e)=>{const s=u("el-button"),i=u("el-table-column"),K=u("el-tag"),R=u("el-table"),E=u("el-option"),$=u("el-select"),p=u("el-form-item"),_=u("el-input"),A=u("el-switch"),M=u("el-form"),N=u("el-dialog");return k(),T("div",X,[w("div",Y,[l(s,{type:"primary",onClick:q},{default:o(()=>[r("新增")]),_:1})]),w("div",Z,[l(R,{data:x.value,style:{width:"100%"}},{default:o(()=>[l(i,{prop:"conclusionType",label:"结论类型",width:"120"},{default:o(({row:a})=>[r(V(h(a.conclusionType)),1)]),_:1}),l(i,{prop:"conclusionScoreKey",label:"结论等级",width:"120"}),l(i,{prop:"conclusionScoreLabel",label:"结论等级中文",width:"120"}),l(i,{prop:"conclusionScoreValue",label:"结论等级描述",width:"120"}),l(i,{prop:"remark",label:"备注模板"}),l(i,{prop:"status",label:"状态",width:"100"},{default:o(({row:a})=>[l(K,{type:a.status==="0"?"success":"info"},{default:o(()=>[r(V(a.status==="0"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(i,{label:"操作",width:"180"},{default:o(({row:a})=>[l(s,{size:"small",onClick:z=>D(a)},{default:o(()=>[r("编辑")]),_:2},1032,["onClick"]),l(s,{size:"small",type:a.status==="0"?"danger":"success",onClick:z=>B(a)},{default:o(()=>[r(V(a.status==="0"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])]),l(N,{modelValue:d.value,"onUpdate:modelValue":e[7]||(e[7]=a=>d.value=a),title:g.value,width:"600px",onClosed:F},{footer:o(()=>[l(s,{onClick:e[6]||(e[6]=a=>d.value=!1)},{default:o(()=>[r("取消")]),_:1}),l(s,{type:"primary",onClick:U,loading:v.value},{default:o(()=>[r("保存")]),_:1},8,["loading"])]),default:o(()=>[l(M,{model:n.value,rules:L,"label-width":"110px",ref_key:"formRef",ref:c,"status-icon":""},{default:o(()=>[l(p,{label:"结论类型",prop:"conclusionType",required:""},{default:o(()=>[l($,{modelValue:n.value.conclusionType,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.conclusionType=a),placeholder:"请选择"},{default:o(()=>[(k(),T(P,null,Q(S,a=>l(E,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"结论等级",prop:"conclusionScoreKey",required:""},{default:o(()=>[l(_,{modelValue:n.value.conclusionScoreKey,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.conclusionScoreKey=a),clearable:""},null,8,["modelValue"])]),_:1}),l(p,{label:"结论等级中文",prop:"conclusionScoreLabel"},{default:o(()=>[l(_,{modelValue:n.value.conclusionScoreLabel,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.conclusionScoreLabel=a),clearable:""},null,8,["modelValue"])]),_:1}),l(p,{label:"结论等级描述",prop:"conclusionScoreValue",required:""},{default:o(()=>[l(_,{modelValue:n.value.conclusionScoreValue,"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.conclusionScoreValue=a),clearable:""},null,8,["modelValue"])]),_:1}),l(p,{label:"备注模板"},{default:o(()=>[l(_,{modelValue:n.value.remark,"onUpdate:modelValue":e[4]||(e[4]=a=>n.value.remark=a),type:"textarea",rows:3,clearable:""},null,8,["modelValue"])]),_:1}),l(p,{label:"状态",prop:"status",required:""},{default:o(()=>[l(A,{modelValue:n.value.status,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.status=a),"active-value":"0","inactive-value":"1","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},oe=H(ee,[["__scopeId","data-v-97335cc8"]]);export{oe as default};
