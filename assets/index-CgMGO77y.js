import{_ as xe,A as F,r as f,a0 as Be,aL as j,g as I,R as Ae,o as i,c as u,e as s,f as o,w as r,h as p,S as Me,F as T,C as O,H as q,i as H,x as M,n as x,m as y,l as G,ai as ae,z as Ye,p as Ue,q as we,t as $e}from"./index-CBERRbij.js";import De from"./dynamicDialog-BJYKRrDw.js";import{e as Ne,a as Pe,b as Fe,c as Te,d as Oe,f as ze,h as Ee,i as Qe,j as Re,k as je}from"./parts-CyCobads.js";const J=N=>(Ue("data-v-840946bd"),N=N(),we(),N),qe={class:"app-container vehicle-models"},He={class:"box-container"},Ge={class:"card-box"},Je={class:"card-header"},Ke=J(()=>s("span",{class:"title"},"品牌",-1)),We={class:"brandSearchBox"},Xe={class:"btnBox"},Ze={class:"contentBox"},ea=["infinite-scroll-disabled"],aa=["onClick"],la={class:"logoBox"},da=["src"],oa={class:"logoText"},ra={class:"btnBox"},sa={class:"listFooter"},ta={key:0},na={key:1},ia={class:"card-box"},ca={class:"card-header"},ua=J(()=>s("span",{class:"title"},"车系",-1)),ma={class:"brandSearchBox"},pa={class:"btnBox"},ba={class:"contentBox"},_a={class:"listBox"},Sa=["onClick"],va={class:"logoBox"},ga=["src"],fa={class:"logoText"},Ia={class:"btnBox"},ya={class:"card-box"},ha={class:"card-header"},Ca=J(()=>s("span",{class:"title"},"车型",-1)),Va={class:"brandSearchBox"},ka={class:"btnBox"},La={class:"contentBox"},xa={class:"listBox"},Ba=["onClick"],Aa={class:"logoText"},Ma={key:0},Ya={class:"btnBox"},Ua={key:0},wa={key:1},$a={key:2},Da={key:3},Na={key:4},Pa={key:5},Fa=Ye({name:"Models"}),Ta=Object.assign(Fa,{setup(N){const{proxy:Y}=$e(),V=F({brand:"",pageNum:1,pageSize:10}),S=F({carSeries:"",brandId:"",pageNum:1,pageSize:100}),m=F({carSeriesId:"",currentModelsID:"",models:"",pageNum:1,pageSize:100}),k=f("新建品牌车系"),v=f([]),U=f(0),z=f([]),K=f([]),b=f(""),L=f(null),g=f(!1),e=F({brand:"",brandId:"",brandLogo:{},carSeriesArrary:[],carSeriesLogo:[],carSeries:"",carSeriesId:"",modelsId:"",models:[{modelYear:"",models:""}]}),E=f();Be(b,l=>{switch(l){case"addBrand":k.value="新建品牌车系",L.value=he;break;case"editBrand":k.value="编辑品牌",L.value=ye;break;case"addCarSeries":k.value="添加车系",L.value=Ce;break;case"editCarSeries":k.value="编辑车系",L.value=Ie;break;case"addCarModels":k.value="添加车型",L.value=Ve;break;case"editCarModels":k.value="编辑车型",L.value=se;break}});const le=async()=>{V.pageNum=1,U.value=0,v.value=[],P()},P=async()=>{const l={...V},{code:d,rows:t,total:n}=await Re(l);d===200&&t&&(U.value=n,Array.prototype.push.apply(v.value,t),V.pageNum==1&&v.value.length>0&&(S.brandId=v.value[0].brandId,S.carSeries="",$()),v.value.length<n&&V.pageNum++)},de=l=>{b.value="editBrand",e.brandLogo=[l.brandLogo],e.brand=l.brand,e.brandId=l.brandId,g.value=!0},oe=()=>{b.value="addBrand",e.brand="",e.brandLogo={},ve(),g.value=!0},re=l=>{var d;b.value="editCarModels",e.models[0].models=l.models,e.models[0].modelYear=(d=l.modelYear)==null?void 0:d.toString(),w(R(X(l.carSeriesId).brandId)),Q(X(l.carSeriesId)),e.modelsId=l.modelsId,g.value=!0},se=async()=>{const l={carSeriesId:e.carSeriesId,models:e.models[0].models,modelYear:e.models[0].modelYear,modelsId:e.modelsId};return await Ne(l)},te=l=>{b.value="addCarSeries",w(l),g.value=!0},ne=l=>{e.models.push({modelYear:"",models:""})},ie=l=>{e.models.splice(l,1)},ce=async l=>{await Y.$modal.confirm("确认删除此车型吗？")&&(await ue(l),Y.$modal.msgSuccess("车型已删除"))},ue=async l=>{const{code:d}=await je(l.modelsId);d===200&&W()},me=l=>{b.value="editCarSeries",w(R(l.brandId)),Q(l),g.value=!0},pe=l=>{Q(l),w(R(l.brandId)),e.models=[{modelYear:"",models:""}],b.value="addCarModels",g.value=!0},be=j.debounce(l=>{S.brandId=l.brandId,S.carSeries="",S.pageNum=1,w(l),$()},500),_e=j.debounce(l=>{m.carSeriesId=l.carSeriesId,m.brandId=l.brandId,m.models="",m.pageNum=1,e.carSeries=l.carSeries,e.carSeriesId=l.carSeriesId,e.carSeriesLogo=l.carSeriesLogo,D()},500),Se=j.debounce(l=>{e.models=l.models,e.carSeriesId=l.carSeriesId,e.modelsId=l.modelsId,e.modelsYear=l.modelYear,m.currentModelsID=l.modelsId},500),w=l=>{e.brand=l.brand,e.brandId=l.brandId,e.brandLogo=l.brandLogo},Q=l=>{e.carSeries=l.carSeries,e.carSeriesId=l.carSeriesId,e.carSeriesLogo=l.carSeriesLogo},ve=()=>{e.carSeries="",e.carSeriesId="",e.carSeriesLogo=""},ge=()=>{E.value.resetFields(),g.value=!1},fe=async()=>{Y.$modal.loading();try{const{code:l}=await L.value();l===200&&(W(),Y.$modal.msgSuccess("操作成功"),E.value.resetFields(),g.value=!1)}finally{Y.$modal.closeLoading()}},W=()=>{switch(b.value){case"addBrand":case"editBrand":v.value=[],V.pageNum=1,U.value=0,P();break;case"addCarSeries":S.carSeries="",S.brandId=e.brandId,$();break;case"editCarSeries":m.models="",$();break;case"addCarModels":m.models="",D();break;case"editCarModels":m.models="",D();break}},R=l=>v.value.find(d=>d.brandId==l),X=l=>z.value.find(d=>d.carSeriesId==l),Ie=async()=>{const l={brandId:e.brandId,carSeries:e.carSeries,carSeriesId:e.carSeriesId,carSeriesLogo:e.carSeriesLogo.length>0?e.carSeriesLogo[0]:{}};return await Pe(l)},ye=async()=>{const l={brand:e.brand,brandId:e.brandId,brandLogo:e.brandLogo[0]};return await Fe(l)},he=async()=>{const l={brand:e.brand,brandLogo:e.brandLogo[0],carSeries:e.carSeriesArrary.map(d=>({carSeries:d,carSeriesLogo:e.carSeriesLogo&&e.carSeriesLogo.length>0?e.carSeriesLogo[0]:null}))};return await Te(l)},Ce=async()=>{const l={brandId:e.brandId,carSeries:e.carSeriesArrary.map(d=>({carSeries:d,carSeriesLogo:e.carSeriesLogo&&e.carSeriesLogo.length>0?e.carSeriesLogo[0]:null}))};return await Oe(l)},Ve=async()=>{const l={carSeriesId:e.carSeriesId,models:e.models};return await ze(l)},$=async()=>{var n;const l={...S},{code:d,rows:t}=await Ee(l);d===200&&(z.value=t,m.carSeriesId=(n=t[0])==null?void 0:n.carSeriesId,m.currentModelsID="",m.models="",D())},D=async()=>{var n,B;const l={...m},{code:d,rows:t}=await Qe(l);d===200&&t&&(K.value=t,e.modelsId=(n=t[0])==null?void 0:n.modelsId,m.currentModelsID=(B=t[0])==null?void 0:B.modelsId)};return P(),(l,d)=>{const t=I("el-input"),n=I("el-button"),B=I("el-card"),c=I("el-form-item"),A=I("Image-Upload"),Z=I("el-input-tag"),h=I("el-col"),ee=I("el-date-picker"),ke=I("el-form"),Le=Ae("infinite-scroll");return i(),u("div",qe,[s("div",He,[s("div",Ge,[o(B,null,{header:r(()=>[s("div",Je,[Ke,s("div",We,[o(t,{modelValue:V.brand,"onUpdate:modelValue":d[0]||(d[0]=a=>V.brand=a),"suffix-icon":"Search",style:{width:"240px"},placeholder:"请输入品牌"},null,8,["modelValue"])]),s("div",Xe,[o(n,{type:"primary",link:"",onClick:le},{default:r(()=>[p("查询")]),_:1}),o(n,{type:"primary",onClick:oe,link:""},{default:r(()=>[p("新增")]),_:1})])])]),default:r(()=>[s("div",Ze,[Me((i(),u("div",{class:"listBox","infinite-scroll-disabled":v.value.length==U.value},[(i(!0),u(T,null,O(v.value,a=>(i(),u("div",{class:q(["listItem",{selectItem:S.brandId==a.brandId}]),key:a.brandId,onClick:_=>H(be)(a)},[s("div",la,[s("img",{src:a.brandLogo.photoOriginal,alt:""},null,8,da)]),s("div",oa,M(a.brand),1),s("div",ra,[o(n,{type:"primary",link:"",onClick:x(_=>te(a),["stop"])},{default:r(()=>[p("添加车系")]),_:2},1032,["onClick"]),o(n,{type:"primary",onClick:x(_=>de(a),["stop"]),link:""},{default:r(()=>[p("编辑")]),_:2},1032,["onClick"])])],10,aa))),128))],8,ea)),[[Le,P]]),s("div",sa,[v.value.length<U.value?(i(),u("p",ta,"加载更多...")):(i(),u("p",na,"没有更多数据啦~"))])])]),_:1})]),s("div",ia,[o(B,null,{header:r(()=>[s("div",ca,[ua,s("div",ma,[o(t,{modelValue:S.carSeries,"onUpdate:modelValue":d[1]||(d[1]=a=>S.carSeries=a),"suffix-icon":"Search",style:{width:"240px"},placeholder:"请输入车系名称"},null,8,["modelValue"])]),s("div",pa,[o(n,{type:"primary",onClick:x($,["stop"]),link:""},{default:r(()=>[p("查询")]),_:1})])])]),default:r(()=>[s("div",ba,[s("div",_a,[(i(!0),u(T,null,O(z.value,a=>{var _;return i(),u("div",{class:q(["listItem",{selectItem:m.carSeriesId==a.carSeriesId}]),key:a.brandId,onClick:C=>H(_e)(a)},[s("div",va,[s("img",{src:(_=a==null?void 0:a.carSeriesLogo)==null?void 0:_.photoOriginal,alt:""},null,8,ga)]),s("div",fa,M(a.carSeries),1),s("div",Ia,[o(n,{type:"primary",link:"",onClick:x(C=>pe(a),["stop"])},{default:r(()=>[p("添加车型")]),_:2},1032,["onClick"]),o(n,{type:"primary",onClick:x(C=>me(a),["stop"]),link:""},{default:r(()=>[p("编辑")]),_:2},1032,["onClick"])])],10,Sa)}),128))])])]),_:1})]),s("div",ya,[o(B,null,{header:r(()=>[s("div",ha,[Ca,s("div",Va,[o(t,{modelValue:m.models,"onUpdate:modelValue":d[2]||(d[2]=a=>m.models=a),"suffix-icon":"Search",style:{width:"240px"},placeholder:"请输入车型名称"},null,8,["modelValue"])]),s("div",ka,[o(n,{type:"primary",link:"",onClick:D},{default:r(()=>[p("查询")]),_:1})])])]),default:r(()=>[s("div",La,[s("div",xa,[(i(!0),u(T,null,O(K.value,a=>(i(),u("div",{class:q(["listItem",{selectItem:m.currentModelsID==a.modelsId}]),key:a.modelsId,onClick:_=>H(Se)(a)},[s("div",Aa,[a.modelYear?(i(),u("span",Ma,M(a.modelYear)+"款",1)):y("",!0),p(M(a.models),1)]),s("div",Ya,[o(n,{type:"primary",onClick:x(_=>re(a),["stop"]),link:""},{default:r(()=>[p("编辑")]),_:2},1032,["onClick"]),o(n,{type:"primary",link:"",onClick:x(_=>ce(a),["stop"])},{default:r(()=>[p("删除")]),_:2},1032,["onClick"])])],10,Ba))),128))])])]),_:1})])]),o(De,{visible:g.value,"onUpdate:visible":d[21]||(d[21]=a=>g.value=a),title:k.value,onClose:ge,onSubmit:fe},{content:r(()=>[o(ke,{ref_key:"ruleFormRef",ref:E,model:e,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:r(()=>[b.value=="addBrand"?(i(),u("div",Ua,[o(c,{label:"品牌名称",prop:"brand"},{default:r(()=>[o(t,{style:{width:"270px"},modelValue:e.brand,"onUpdate:modelValue":d[3]||(d[3]=a=>e.brand=a),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"品牌logo",prop:"brandLogo"},{default:r(()=>[o(A,{limit:1,modelValue:e.brandLogo,"onUpdate:modelValue":d[4]||(d[4]=a=>e.brandLogo=a)},null,8,["modelValue"])]),_:1}),o(c,{label:"车系名称",prop:"carSeriesArrary"},{default:r(()=>[o(Z,{style:{width:"270px"},modelValue:e.carSeriesArrary,"onUpdate:modelValue":d[5]||(d[5]=a=>e.carSeriesArrary=a),clearable:"",placeholder:"请输入车系名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"车系logo",prop:"carSeriesLogo"},{default:r(()=>[o(A,{limit:1,modelValue:e.carSeriesLogo,"onUpdate:modelValue":d[6]||(d[6]=a=>e.carSeriesLogo=a)},null,8,["modelValue"])]),_:1})])):y("",!0),b.value=="editBrand"?(i(),u("div",wa,[o(c,{label:"品牌名称",prop:"brand"},{default:r(()=>[o(t,{style:{width:"270px"},modelValue:e.brand,"onUpdate:modelValue":d[7]||(d[7]=a=>e.brand=a),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"品牌logo",prop:"brandLogo"},{default:r(()=>[o(A,{limit:1,modelValue:e.brandLogo,"onUpdate:modelValue":d[8]||(d[8]=a=>e.brandLogo=a)},null,8,["modelValue"])]),_:1})])):y("",!0),b.value=="addCarSeries"?(i(),u("div",$a,[o(c,{label:"品牌名称",prop:"brand"},{default:r(()=>[o(t,{style:{width:"270px"},disabled:!0,modelValue:e.brand,"onUpdate:modelValue":d[9]||(d[9]=a=>e.brand=a),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"品牌logo",prop:"brandLogo"},{default:r(()=>[o(A,{disabled:!0,isShowTip:!1,limit:1,modelValue:e.brandLogo,"onUpdate:modelValue":d[10]||(d[10]=a=>e.brandLogo=a)},null,8,["modelValue"])]),_:1}),o(c,{label:"车系名称",prop:"carSeriesArrary"},{default:r(()=>[o(Z,{style:{width:"270px"},modelValue:e.carSeriesArrary,"onUpdate:modelValue":d[11]||(d[11]=a=>e.carSeriesArrary=a),clearable:"",placeholder:"请输入车系名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"车系logo",prop:"carSeriesLogo"},{default:r(()=>[o(A,{limit:1,modelValue:e.carSeriesLogo,"onUpdate:modelValue":d[12]||(d[12]=a=>e.carSeriesLogo=a)},null,8,["modelValue"])]),_:1})])):y("",!0),b.value=="editCarSeries"?(i(),u("div",Da,[o(c,{label:"车系名称",prop:"carSeries"},{default:r(()=>[o(t,{style:{width:"270px"},modelValue:e.carSeries,"onUpdate:modelValue":d[13]||(d[13]=a=>e.carSeries=a),placeholder:"请输入车系名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"车系logo",prop:"carSeriesLogo"},{default:r(()=>[o(A,{limit:1,modelValue:e.carSeriesLogo,"onUpdate:modelValue":d[14]||(d[14]=a=>e.carSeriesLogo=a)},null,8,["modelValue"])]),_:1})])):y("",!0),b.value=="addCarModels"?(i(),u("div",Na,[o(c,{label:"品牌名称",prop:"brand"},{default:r(()=>[o(t,{style:{width:"270px"},disabled:!0,modelValue:e.brand,"onUpdate:modelValue":d[15]||(d[15]=a=>e.brand=a),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"车系名称",prop:"carSeries"},{default:r(()=>[o(t,{style:{width:"270px"},disabled:!0,modelValue:e.carSeries,"onUpdate:modelValue":d[16]||(d[16]=a=>e.carSeries=a),placeholder:"请输入车系名称"},null,8,["modelValue"])]),_:1}),(i(!0),u(T,null,O(e.models,(a,_)=>(i(),G(c,{label:"车型名称",key:_},{default:r(()=>[o(h,{span:6},{default:r(()=>[o(t,{style:{width:"270px"},modelValue:a.models,"onUpdate:modelValue":C=>a.models=C,placeholder:"请输入车型名称"},ae({_:2},[e.models[0].modelYear?{name:"prepend",fn:r(()=>[p(M(a.modelYear)+" 款",1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(h,{span:1}),o(h,{span:6},{default:r(()=>[o(ee,{style:{width:"270px"},modelValue:a.modelYear,"onUpdate:modelValue":C=>a.modelYear=C,type:"year","value-format":"YYYY",format:"YYYY",placeholder:"请选择年款"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(h,{span:1}),o(h,{span:8},{default:r(()=>[_!=0?(i(),G(n,{key:0,type:"danger",onClick:C=>ie(_)},{default:r(()=>[p("删除")]),_:2},1032,["onClick"])):y("",!0),_==e.models.length-1?(i(),G(n,{key:1,type:"primary",onClick:C=>ne(a)},{default:r(()=>[p("添加")]),_:2},1032,["onClick"])):y("",!0)]),_:2},1024)]),_:2},1024))),128))])):y("",!0),b.value=="editCarModels"?(i(),u("div",Pa,[o(c,{label:"品牌名称",prop:"brand"},{default:r(()=>[o(t,{style:{width:"270px"},disabled:!0,modelValue:e.brand,"onUpdate:modelValue":d[17]||(d[17]=a=>e.brand=a),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"车系名称",prop:"carSeries"},{default:r(()=>[o(t,{style:{width:"270px"},disabled:!0,modelValue:e.carSeries,"onUpdate:modelValue":d[18]||(d[18]=a=>e.carSeries=a),placeholder:"请输入车系名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"车型名称",prop:"models"},{default:r(()=>[o(h,{span:6},{default:r(()=>[o(t,{style:{width:"270px"},modelValue:e.models[0].models,"onUpdate:modelValue":d[19]||(d[19]=a=>e.models[0].models=a),placeholder:"请输入车型名称"},ae({_:2},[e.models[0].modelYear?{name:"prepend",fn:r(()=>[p(M(e.models[0].modelYear)+" 款",1)]),key:"0"}:void 0]),1032,["modelValue"])]),_:1}),o(h,{span:1}),o(h,{span:6},{default:r(()=>[o(ee,{style:{width:"270px"},modelValue:e.models[0].modelYear,"onUpdate:modelValue":d[20]||(d[20]=a=>e.models[0].modelYear=a),type:"year","value-format":"YYYY",placeholder:"请选择年款"},null,8,["modelValue"])]),_:1})]),_:1})])):y("",!0)]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}}),Qa=xe(Ta,[["__scopeId","data-v-840946bd"]]);export{Qa as default};
