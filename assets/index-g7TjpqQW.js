import{_ as us,a as cs,r as B,u as ms,A as ps,v as fs,b as vs,a5 as _s,J as hs,g as b,o,c as i,e as r,f,w as m,F as k,C,i as s,l as v,B as P,h as x,x as I,m as p,z as Is,t as ys,aL as te,b9 as gs,ba as bs,p as ks,q as Cs}from"./index-Bz8aCySx.js";import{$ as Bs}from"./index-CXdL54YQ.js";import{v as Ls,s as Ds}from"./vehicleDamageInfoTemplate-DJGyKmh2.js";import{M as Vs,p as Re,q as Se,F as j,N as d,O as ws,s as L,P as oe,Q as W,R as F,S as M,n as D,z,v as A,e as y,g as xs,r as q,j as H,E as Es,T as J,L as Ps,H as Ts,A as Ns,C as je,J as Rs,u as Ss,k as js,a as Ae,b as As}from"./useOrderInfo-oTm2EOs0.js";import $s from"./baseInfoTemplate-D7prYdFo.js";import Us from"./standardPhotoTemplate-nL5LsqSL.js";import Os from"./chassisInfoTemplate-Bi7wDjI_.js";import Gs from"./editChassisEvaluationItems-pAoeVkV1.js";import Ws from"./editBodyWorkEvaluationItems-DOEct2lR.js";import Fs from"./bodyWorkTemplate-42eyeDxV.js";import Ms from"./index-DA4sBmx0.js";import zs from"./powerBatteryPanel-Dou83TEH.js";import{r as qs,s as Hs}from"./recheckInfoTemplate-C2-wh0RN.js";import Js from"./orderInfoDialog-CHjeVXK7.js";import Qs from"./rejectionEvaluatedDialog-ykdfBuMx.js";import"./uploadVehicleDamageZip-DNOzsa65.js";import"./empty-X662_Asi.js";import"./swiper-LA7WfxAj.js";/* empty css             *//* empty css                   *//* empty css                   */import"./swiper-vue-Cu1ZKMQW.js";import"./zoom-Ca8q2gD7.js";import"./toBeEvaluated-Bo3_wRio.js";import"./ratingSetting-U-JgFuAd.js";const $=U=>(ks("data-v-0852097a"),U=U(),Cs(),U),Ys={class:"app-container"},Ks={class:"main"},Xs={class:"mainBox"},Zs={key:0,class:"switch-pending"},ea={key:0,class:"dismissBox"},sa={class:"header-dismiss"},aa=$(()=>r("div",{class:"header"},"驳回",-1)),ta={key:0,class:"editBaseInfo"},oa={class:"content"},na={key:0,class:"baseInfo"},ra=$(()=>r("div",{class:"title"},"行驶证信息",-1)),la={key:0,class:"referCarInfo"},ia={class:"infoList"},da={class:"infoItem"},ua={class:"dicLabel"},ca=$(()=>r("div",{class:"title"},"登记证信息",-1)),ma={class:"infoList"},pa={class:"dicLabel"},fa=$(()=>r("div",{class:"title"},"其他信息",-1)),va={class:"infoList"},_a={class:"dicLabel"},ha={key:1,class:"ecoChassisBox"},Ia={class:"selectChassisPointsBox"},ya={key:0,class:"chassisInfo"},ga={class:"chassisInfo-box"},ba={class:"chassisInfo-item-title"},ka={key:1,class:"chassisInfo"},Ca={class:"chassisInfo-box"},Ba={class:"chassisInfo-item-title"},La={class:"editAssessment"},Da={key:2,class:"isUndetectable"},Va={key:0},wa={key:1},xa={class:"rejectOther"},Ea=$(()=>r("div",{class:"title"},"驳回原因",-1)),Pa={class:"infoList infoListImgBox"},Ta={class:"dicLabel"},Na={key:1,class:"infoBox"},Ra={class:"infoBox footer-sub"},Sa=Is({name:"ToBeEvaluated/:id"}),ja=Object.assign(Sa,{setup(U){const ne=cs(),Q=B(null),Y=B(!1),K=B(!1),X=B(!1);Vs();const{proxy:h}=ys(),T=B(h.useDict("base_info_id","order_base_driving_license","energy_type","vehicle_category","nature_of_use","body_color","inlet_homebred","annual_ianspection_status","compulsory_traffic_insurance_status","order_base_registration_certificate","order_base_others_info","other_photographs_procedure","photographs_procedure","upholstery_color","general_image_evaluation","color_change_status","sys_yes_no","battery_type","collision_area")),re=B(null),{detection_type:$e}=h.useDict("detection_type"),E=ms();B(null);const Z=ps({orderInfoDialogVisible:!1,orderInfoDetail:{}}),Ue=a=>{var n;const e=((n=L.value)==null?void 0:n.drivingLicenseInfo)||{};if(e.otherSeries){if((a.value==="carSeries"||a.value==="models")&&!e[a.value])return!1}else if(a.value==="otherSeries")return!1;return!0},Oe=async a=>{console.log("当前选中标签:",Es.value,a);try{return h.$modal.loading("加载中..."),d.value==="powerBatteryPanel"?(await re.value.handleCheckConclusion(),D.value=null,await J(a)):d.value==="vehicleDamageInfo"?(await Ds(Ps.value),D.value=null,await J(a)):d.value==="recheckInfo"?(await Hs(Ts.value),D.value=null,await J(a)):await Me(a)?(D.value=null,await J(a)):!1}finally{h.$modal.closeLoading()}},Ge=a=>{let e={detectionType:a.detectionType,orderId:E.params.id,partsId:a.partsId};Ns(e),console.log("新能源地盘部位选择、",a)},We=()=>{Y.value=!0},Fe=()=>{K.value=!0},Me=async()=>{const{apiName:a,params:e}=le(d.value);try{h.$modal.loading("加载中...");const n=await a(e);return n===200||!te.isNumber(n)?(h.$modal.msgSuccess("保存成功"),!0):(h.$modal.msgError("保存失败，请重试"),!1)}catch(n){return console.error("Error saving base info:",n),!1}finally{h.$modal.closeLoading()}},ee=fs(()=>{var a;return console.log("chassisAssessmentInfoDataList.value",Re.value,Se.value),(a=Re.value)==null?void 0:a[Se.value]}),ze=(a,e)=>{const n=a.find(l=>l.productAssessmentId===e.productAssessmentId);return n==null?void 0:n.assessmentName},qe=(a,e)=>{const n=a.find(u=>u.productAssessmentId===e.productAssessmentId),l=n==null?void 0:n.evaluationCriteriaList.find(u=>u.assessmentEvaluationCriteriaId===e.assessmentEvaluationCriteriaId);return l==null?void 0:l.damageDescription},He=a=>{const e=je.value.find(n=>n.productAssessmentId===a);return e==null?void 0:e.assessmentName},Je=(a,e)=>{const n=je.value.find(u=>u.productAssessmentId===a),l=n==null?void 0:n.evaluationCriteriaList.find(u=>u.assessmentEvaluationCriteriaId===e);return l==null?void 0:l.damageDescription},le=a=>{var e,n,l,u;if(a=="orderBase")return{apiName:gs,params:es()};if(a=="orderStandard")return{apiName:Rs,params:null};if(a=="orderChassis"||a=="ecoChassis")return{apiName:Ss,params:null};if(a=="orderBodyWork"){let V={detectionType:(e=y.value)==null?void 0:e.detectionType,partsId:y.value.partsId,orderId:E.params.id,rejectedItem:q.value,rejectedRemark:H.value,orderDetectionRejectedItemId:((u=(l=(n=y)==null?void 0:n.value)==null?void 0:l.rejectedItem)==null?void 0:u.orderDetectionRejectedItemId)||null};return{apiName:js,params:V}}return null},se=(a,e)=>Array.isArray(e)?te.isArray(a)?e.map(n=>({...n,delFlag:a.includes(n.elementName)?0:1})).concat(a.filter(n=>!e.some(l=>l.elementName===n)).map(n=>({elementName:n}))):a.map(n=>({elementName:n})):Array.isArray(a)?a.map(n=>({elementName:n})):[],Qe=()=>{Q.value.openDialog("不予评测","noEvaluation")},Ye=async()=>{await Ke(d.value)&&Q.value.openDialog("订单驳回补充说明（非必填）","dismiss")},Ke=async()=>{h.$modal.loading("加载中...");const{apiName:a,params:e}=le(d.value);try{if(await h.$modal.confirm("驳回整单前，需要保存当前驳回项信息，请确认保存当前信息？")){const l=await a(e);return l===200||!te.isNumber(l)?(h.$modal.msgSuccess("保存成功"),!0):(h.$modal.msgError("保存失败，请重试"),!1)}return!1}catch(n){return console.error("Error saving base info:",n),!1}finally{h.$modal.closeLoading()}},Xe=async()=>{await h.$modal.confirm("确认挂起当前订单么？")?(await bs(E.params.id),h.$modal.msgSuccess("订单已挂起"),ne.push({path:"/evaluationManagement/pendingEvaluationList"})):h.$modal.msgError("已取消挂起")},Ze=()=>{ne.push({path:`/evaluationManagement/conclusion/view/${E.params.id}`})},es=()=>{var e,n,l;let a={drivingLicenseInfo:{elementRejectedItem:[]},registrationCertificateInfo:{elementRejectedItem:[]},othersInfo:{elementRejectedItem:[]}};return Ae.value&&(As(Ae.value),a={...L.value}),a.drivingLicenseInfo.elementRejectedItem=se(W.value,(e=L.value.drivingLicenseInfo)==null?void 0:e.elementRejectedItem),a.orderId=E.params.id,a.registrationCertificateInfo.elementRejectedItem=se(F.value,(n=L.value.registrationCertificateInfo)==null?void 0:n.elementRejectedItem),a.othersInfo.elementRejectedItem=se(M.value,(l=L.value.othersInfo)==null?void 0:l.elementRejectedItem),a},ss=()=>{Z.orderInfoDialogVisible=!0},as=()=>{X.value=!0},N=B(null),w=B(300),O=B(null),G=()=>{w.value=0,O.value=null,N.value&&(clearInterval(N.value),N.value=null)},ie=(a,e)=>{if(!["3","5"].includes(a)){G();return}const l=new Date(e).getTime(),u=Date.now();if(w.value=Math.floor((l+3e5-u)/1e3),w.value<0){G();return}N.value=setInterval(()=>{w.value>0?w.value-=1:G()},1e3)},de=()=>{document.visibilityState==="visible"?O.value&&j.value&&ie(j.value,O.value):N.value&&clearInterval(N.value)},ae=(a,e)=>{if(!a.remark)return typeof e=="string"||typeof e=="number"?e||"--":Array.isArray(e)&&e.length?e.join(", "):"--";const n=T.value[a.remark]||[];if(typeof e=="string"||typeof e=="number"){const l=n.find(u=>u.value===e);return l?l.label:e||"--"}else if(Array.isArray(e)){const l=e.map(u=>{const V=n.find(R=>R.value===u);return V?V.label:u}).filter(u=>u);return l.length?l.join(", "):"--"}return"--"};return vs(()=>{Bs.getAllOrderInfo(E.params.id).then(a=>{a&&(j.value=a.data.orderType,O.value=a.data.createTime,ie(a.data.orderType,a.data.createTime))}),document.addEventListener("visibilitychange",de)}),_s(()=>{d.value="orderBase",G(),document.removeEventListener("visibilitychange",de)}),hs("dictList",T),(a,e)=>{var me,pe,fe,ve,_e,he,Ie,ye,ge,be,ke,Ce,Be,Le,De,Ve,we,xe,Ee,Pe;const n=b("el-tab-pane"),l=b("el-tabs"),u=b("el-button"),V=b("el-checkbox"),R=b("el-checkbox-group"),ts=b("dict-tag"),os=b("el-menu-item"),ue=b("el-menu-item-group"),ce=b("el-sub-menu"),ns=b("el-menu"),rs=b("el-option"),ls=b("el-select"),is=b("el-input");return o(),i("div",Ys,[r("div",{class:"rightFloat"},[r("div",{class:"rightFloat-box"},[r("div",{class:"slider-btnItem",onClick:ss},"订单信息")])]),r("div",Ks,[r("div",Xs,[f(l,{modelValue:s(d),"onUpdate:modelValue":e[0]||(e[0]=t=>P(d)?d.value=t:null),class:"evaluateTabs","before-leave":Oe},{default:m(()=>[(o(!0),i(k,null,C(s(ws),t=>(o(),v(n,{label:t.label,name:t.name},null,8,["label","name"]))),256))]),_:1},8,["modelValue"]),["3","4","5","6","7"].includes(s(j))?(o(),i("div",Zs,[["3","5"].includes(s(j))?(o(),v(u,{key:0,type:w.value?"success":"danger"},{default:m(()=>[x(I(w.value?w.value:"延时"),1)]),_:1},8,["type"])):p("",!0),f(u,{type:"warning",onClick:Xe},{default:m(()=>[x("挂起")]),_:1})])):p("",!0),s(d)==="orderBase"?(o(),v($s,{key:1})):p("",!0),s(d)==="orderStandard"?(o(),v(Us,{key:2})):p("",!0),s(d)==="orderChassis"||s(d)==="ecoChassis"?(o(),v(Os,{key:3})):p("",!0),s(d)==="orderBodyWork"?(o(),v(Fs,{key:4})):p("",!0),s(d)==="powerBatteryPanel"?(o(),v(zs,{key:5,ref_key:"powerBatteryPanelRef",ref:re},null,512)):p("",!0),s(d)==="vehicleDamageInfo"?(o(),v(Ls,{key:6})):p("",!0),s(d)==="recheckInfo"?(o(),v(qs,{key:7})):p("",!0)]),s(d)==="powerBatteryPanel"||s(d)==="vehicleDamageInfo"||s(d)==="recheckInfo"?p("",!0):(o(),i("div",ea,[r("div",sa,[aa,["3","4","5","6","7","8"].includes(s(j))&&s(d)==="orderBase"?(o(),i("div",ta,[f(u,{size:"small",type:"primary",onClick:as},{default:m(()=>[x(" 编辑基础信息 ")]),_:1})])):p("",!0)]),r("div",oa,[s(d)==="orderBase"?(o(),i("div",na,[f(R,{class:"infoBox",modelValue:s(W),"onUpdate:modelValue":e[1]||(e[1]=t=>P(W)?W.value=t:null)},{default:m(()=>{var t,c,_,g;return[ra,(c=(t=s(L))==null?void 0:t.drivingLicenseInfo)!=null&&c.referCarBrandInfo?(o(),i("div",la," 精友车型："+I((g=(_=s(L))==null?void 0:_.drivingLicenseInfo)==null?void 0:g.referCarBrandInfo),1)):p("",!0),r("div",ia,[(o(!0),i(k,null,C(s(oe)(T.value.order_base_driving_license),(S,ds)=>(o(),i("div",{key:ds},[Ue(S)?(o(),v(V,{key:0,value:S.value},{default:m(()=>{var Te,Ne;return[r("div",da,[r("span",ua,I(S.label)+"：",1),r("span",null,I(ae(S,(Ne=(Te=s(L))==null?void 0:Te.drivingLicenseInfo)==null?void 0:Ne[S.value])),1)])]}),_:2},1032,["value"])):p("",!0)]))),128))])]}),_:1},8,["modelValue"]),f(R,{class:"infoBox",modelValue:s(F),"onUpdate:modelValue":e[2]||(e[2]=t=>P(F)?F.value=t:null)},{default:m(()=>[ca,r("div",ma,[(o(!0),i(k,null,C(s(oe)(T.value.order_base_registration_certificate),(t,c)=>(o(),i("div",{class:"infoItem",key:c},[f(V,{value:t.value},{default:m(()=>{var _,g;return[r("span",pa,I(t.label)+"：",1),r("span",null,I(ae(t,(g=(_=s(L))==null?void 0:_.registrationCertificateInfo)==null?void 0:g[t.value])),1)]}),_:2},1032,["value"])]))),128))])]),_:1},8,["modelValue"]),f(R,{class:"infoBox",modelValue:s(M),"onUpdate:modelValue":e[3]||(e[3]=t=>P(M)?M.value=t:null)},{default:m(()=>[fa,r("div",va,[(o(!0),i(k,null,C(s(oe)(T.value.order_base_others_info),(t,c)=>(o(),i("div",{class:"infoItem",key:c},[f(V,{value:t.value},{default:m(()=>{var _,g;return[r("span",_a,I(t.label)+"：",1),r("span",null,I(ae(t,(g=(_=s(L))==null?void 0:_.othersInfo)==null?void 0:g[t.value])),1)]}),_:2},1032,["value"])]))),128))])]),_:1},8,["modelValue"])])):p("",!0),((me=s(D))==null?void 0:me.type)=="ecoChassis"?(o(),i("div",ha,[f(ns,{"default-active":`${(pe=s(z))==null?void 0:pe.chassisBearingDetectionPartsGroupList[0].partsList[0].assessmentGroupList[0].partsId}-${(fe=s(z))==null?void 0:fe.chassisBearingDetectionPartsGroupList[0].partsList[0].assessmentGroupList[0].detectionType}`,class:"el-menu-ecoChassisBox"},{default:m(()=>{var t;return[(o(!0),i(k,null,C((t=s(z))==null?void 0:t.chassisBearingDetectionPartsGroupList,c=>(o(),v(ce,{class:"subMenu-chassisInfo",index:c==null?void 0:c.protocolsPartsGroupId,key:c==null?void 0:c.protocolsPartsGroupId},{title:m(()=>[r("span",null,I(c==null?void 0:c.groupName),1)]),default:m(()=>[f(ue,null,{default:m(()=>[(o(!0),i(k,null,C(c==null?void 0:c.partsList,_=>(o(),v(ce,{index:`${_.partsId}`},{title:m(()=>[r("span",null,I(_.partsName),1)]),default:m(()=>[f(ue,null,{default:m(()=>[(o(!0),i(k,null,C(_==null?void 0:_.assessmentGroupList,g=>(o(),v(os,{index:`${g.partsId}-${g.detectionType}`,onClick:S=>Ge(g)},{default:m(()=>[f(ts,{options:s($e),value:g.detectionType},null,8,["options","value"])]),_:2},1032,["index","onClick"]))),256))]),_:2},1024)]),_:2},1032,["index"]))),256))]),_:2},1024)]),_:2},1032,["index"]))),128))]}),_:1},8,["default-active"]),r("div",Ia,[f(ls,{modelValue:s(A),"onUpdate:modelValue":e[4]||(e[4]=t=>P(A)?A.value=t:null),multiple:"",placeholder:"请选择伤损图片"},{default:m(()=>{var t;return[(o(!0),i(k,null,C((t=s(z))==null?void 0:t.chassisPoint,c=>(o(),v(rs,{key:c,label:c,value:c},null,8,["label","value"]))),128))]}),_:1},8,["modelValue"])])])):p("",!0),r("div",null,[s(d)==="orderChassis"||s(d)==="ecoChassis"?(o(),i("div",ya,[r("div",ga,[(o(!0),i(k,null,C((ve=ee.value)==null?void 0:ve.assessmentSelectInfoList,t=>(o(),i("div",ba,I(He(t.productAssessmentId))+": "+I(Je(t.productAssessmentId,t.assessmentEvaluationCriteriaId)),1))),256))])])):p("",!0),s(d)==="orderBodyWork"&&!((_e=s(y))!=null&&_e.isRestrictedUndetectable)&&!((he=s(y))!=null&&he.isNoSuchPart)?(o(),i("div",ka,[r("div",Ca,[(o(!0),i(k,null,C((ge=(ye=(Ie=s(y))==null?void 0:Ie.assessmentPhotoList)==null?void 0:ye[s(xs)])==null?void 0:ge.assessmentSelectInfoList,t=>{var c,_;return o(),i("div",Ba,I(ze((c=s(y))==null?void 0:c.assessmentInfoList,t))+": "+I(qe((_=s(y))==null?void 0:_.assessmentInfoList,t)),1)}),256))])])):p("",!0),r("div",La,[s(d)==="orderChassis"||s(d)==="ecoChassis"&&((be=s(D))!=null&&be.partsId&&s(A)&&s(A).length>0||((ke=s(D))==null?void 0:ke.row)!="ecoChassis")?(o(),v(u,{key:0,size:"small",type:"primary",onClick:We},{default:m(()=>[x("编辑评测项")]),_:1})):p("",!0),s(d)==="orderBodyWork"&&!((Ce=s(y))!=null&&Ce.isRestrictedUndetectable)&&!((Be=s(y))!=null&&Be.isNoSuchPart)?(o(),v(u,{key:1,size:"small",type:"primary",onClick:Fe},{default:m(()=>[x("编辑评测项")]),_:1})):p("",!0),s(d)==="orderBodyWork"&&((Le=s(y))!=null&&Le.isRestrictedUndetectable||(De=s(y))!=null&&De.isNoSuchPart)?(o(),i("div",Da,[(Ve=s(y))!=null&&Ve.isRestrictedUndetectable?(o(),i("div",Va,"受限不可检测")):p("",!0),(we=s(y))!=null&&we.isNoSuchPart?(o(),i("div",wa,"无此部件")):p("",!0)])):p("",!0),f(Ws,{modelValue:K.value,"onUpdate:modelValue":e[5]||(e[5]=t=>K.value=t)},null,8,["modelValue"]),f(Gs,{modelValue:Y.value,"onUpdate:modelValue":e[6]||(e[6]=t=>Y.value=t),chassisItem:ee.value&&{...ee.value}},null,8,["modelValue","chassisItem"])])]),r("div",xa,[((xe=s(D))==null?void 0:xe.type)!="ecoChassis"?(o(),v(R,{key:0,class:"infoBox",modelValue:s(q),"onUpdate:modelValue":e[7]||(e[7]=t=>P(q)?q.value=t:null)},{default:m(()=>[Ea,r("div",Pa,[(o(!0),i(k,null,C(T.value.general_image_evaluation,(t,c)=>(o(),i("div",{class:"infoItem infoItemImg",key:c},[f(V,{value:t.value},{default:m(()=>[r("span",Ta,I(t.label),1)]),_:2},1032,["value"])]))),128))])]),_:1},8,["modelValue"])):p("",!0),((Ee=s(D))==null?void 0:Ee.type)!="ecoChassis"?(o(),i("div",Na,[f(is,{modelValue:s(H),"onUpdate:modelValue":e[8]||(e[8]=t=>P(H)?H.value=t:null),placeholder:"请输入内容"},null,8,["modelValue"])])):p("",!0),r("div",Ra,[f(u,{type:"primary",onClick:Qe},{default:m(()=>[x("不予评测")]),_:1}),((Pe=s(D))==null?void 0:Pe.type)!="ecoChassis"?(o(),v(u,{key:0,type:"primary",onClick:Ye},{default:m(()=>[x("驳回")]),_:1})):p("",!0),f(u,{type:"primary",onClick:Ze},{default:m(()=>[x("查看结论")]),_:1})])])])]))]),f(Js,{visible:Z.orderInfoDialogVisible,"onUpdate:visible":e[9]||(e[9]=t=>Z.orderInfoDialogVisible=t),orderId:s(E).params.id},null,8,["visible","orderId"]),f(Qs,{ref_key:"rejectionEvaluatedDialogRef",ref:Q},null,512),f(Ms,{visible:X.value,"onUpdate:visible":e[10]||(e[10]=t=>X.value=t)},null,8,["visible"])])}}}),it=us(ja,[["__scopeId","data-v-0852097a"]]);export{it as default};
