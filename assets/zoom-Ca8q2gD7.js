import{h as ge,e as ne,d as A,i as se,j as re}from"./swiper-LA7WfxAj.js";function Ee(oe){let{swiper:a,extendParams:le,on:E,emit:ce}=oe;const x=ge();le({zoom:{enabled:!1,limitToOriginalSize:!1,maxRatio:3,minRatio:1,panOnMouseMove:!1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}}),a.zoom={enabled:!1};let u=1,D=!1,C=!1,v={x:0,y:0};const q=-3;let w,S;const r=[],e={originX:0,originY:0,slideEl:void 0,slideWidth:void 0,slideHeight:void 0,imageEl:void 0,imageWrapEl:void 0,maxRatio:3},t={isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},l={x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0};let H=1;Object.defineProperty(a.zoom,"scale",{get(){return H},set(i){if(H!==i){const s=e.imageEl,n=e.slideEl;ce("zoomChange",i,s,n)}H=i}});function G(){if(r.length<2)return 1;const i=r[0].pageX,s=r[0].pageY,n=r[1].pageX,o=r[1].pageY;return Math.sqrt((n-i)**2+(o-s)**2)}function Z(){const i=a.params.zoom,s=e.imageWrapEl.getAttribute("data-swiper-zoom")||i.maxRatio;if(i.limitToOriginalSize&&e.imageEl&&e.imageEl.naturalWidth){const n=e.imageEl.naturalWidth/e.imageEl.offsetWidth;return Math.min(n,s)}return s}function me(){if(r.length<2)return{x:null,y:null};const i=e.imageEl.getBoundingClientRect();return[(r[0].pageX+(r[1].pageX-r[0].pageX)/2-i.x-x.scrollX)/u,(r[0].pageY+(r[1].pageY-r[0].pageY)/2-i.y-x.scrollY)/u]}function ue(){return a.isElement?"swiper-slide":`.${a.params.slideClass}`}function X(i){const s=ue();return!!(i.target.matches(s)||a.slides.filter(n=>n.contains(i.target)).length>0)}function j(i){const s=`.${a.params.zoom.containerClass}`;return!!(i.target.matches(s)||[...a.hostEl.querySelectorAll(s)].filter(n=>n.contains(i.target)).length>0)}function k(i){if(i.pointerType==="mouse"&&r.splice(0,r.length),!X(i))return;const s=a.params.zoom;if(w=!1,S=!1,r.push(i),!(r.length<2)){if(w=!0,e.scaleStart=G(),!e.slideEl){e.slideEl=i.target.closest(`.${a.params.slideClass}, swiper-slide`),e.slideEl||(e.slideEl=a.slides[a.activeIndex]);let n=e.slideEl.querySelector(`.${s.containerClass}`);if(n&&(n=n.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),e.imageEl=n,n?e.imageWrapEl=A(e.imageEl,`.${s.containerClass}`)[0]:e.imageWrapEl=void 0,!e.imageWrapEl){e.imageEl=void 0;return}e.maxRatio=Z()}if(e.imageEl){const[n,o]=me();e.originX=n,e.originY=o,e.imageEl.style.transitionDuration="0ms"}D=!0}}function _(i){if(!X(i))return;const s=a.params.zoom,n=a.zoom,o=r.findIndex(c=>c.pointerId===i.pointerId);o>=0&&(r[o]=i),!(r.length<2)&&(S=!0,e.scaleMove=G(),e.imageEl&&(n.scale=e.scaleMove/e.scaleStart*u,n.scale>e.maxRatio&&(n.scale=e.maxRatio-1+(n.scale-e.maxRatio+1)**.5),n.scale<s.minRatio&&(n.scale=s.minRatio+1-(s.minRatio-n.scale+1)**.5),e.imageEl.style.transform=`translate3d(0,0,0) scale(${n.scale})`))}function B(i){if(!X(i)||i.pointerType==="mouse"&&i.type==="pointerout")return;const s=a.params.zoom,n=a.zoom,o=r.findIndex(c=>c.pointerId===i.pointerId);o>=0&&r.splice(o,1),!(!w||!S)&&(w=!1,S=!1,e.imageEl&&(n.scale=Math.max(Math.min(n.scale,e.maxRatio),s.minRatio),e.imageEl.style.transitionDuration=`${a.params.speed}ms`,e.imageEl.style.transform=`translate3d(0,0,0) scale(${n.scale})`,u=n.scale,D=!1,n.scale>1&&e.slideEl?e.slideEl.classList.add(`${s.zoomedSlideClass}`):n.scale<=1&&e.slideEl&&e.slideEl.classList.remove(`${s.zoomedSlideClass}`),n.scale===1&&(e.originX=0,e.originY=0,e.slideEl=void 0)))}let F;function P(){a.touchEventsData.preventTouchMoveFromPointerMove=!1}function de(){clearTimeout(F),a.touchEventsData.preventTouchMoveFromPointerMove=!0,F=setTimeout(()=>{a.destroyed||P()})}function fe(i){const s=a.device;if(!e.imageEl||t.isTouched)return;s.android&&i.cancelable&&i.preventDefault(),t.isTouched=!0;const n=r.length>0?r[0]:i;t.touchesStart.x=n.pageX,t.touchesStart.y=n.pageY}function J(i){const n=i.pointerType==="mouse"&&a.params.zoom.panOnMouseMove;if(!X(i)||!j(i))return;const o=a.zoom;if(!e.imageEl)return;if(!t.isTouched||!e.slideEl){n&&N(i);return}if(n){N(i);return}t.isMoved||(t.width=e.imageEl.offsetWidth||e.imageEl.clientWidth,t.height=e.imageEl.offsetHeight||e.imageEl.clientHeight,t.startX=re(e.imageWrapEl,"x")||0,t.startY=re(e.imageWrapEl,"y")||0,e.slideWidth=e.slideEl.offsetWidth,e.slideHeight=e.slideEl.offsetHeight,e.imageWrapEl.style.transitionDuration="0ms");const c=t.width*o.scale,p=t.height*o.scale;if(t.minX=Math.min(e.slideWidth/2-c/2,0),t.maxX=-t.minX,t.minY=Math.min(e.slideHeight/2-p/2,0),t.maxY=-t.minY,t.touchesCurrent.x=r.length>0?r[0].pageX:i.pageX,t.touchesCurrent.y=r.length>0?r[0].pageY:i.pageY,Math.max(Math.abs(t.touchesCurrent.x-t.touchesStart.x),Math.abs(t.touchesCurrent.y-t.touchesStart.y))>5&&(a.allowClick=!1),!t.isMoved&&!D){if(a.isHorizontal()&&(Math.floor(t.minX)===Math.floor(t.startX)&&t.touchesCurrent.x<t.touchesStart.x||Math.floor(t.maxX)===Math.floor(t.startX)&&t.touchesCurrent.x>t.touchesStart.x)){t.isTouched=!1,P();return}if(!a.isHorizontal()&&(Math.floor(t.minY)===Math.floor(t.startY)&&t.touchesCurrent.y<t.touchesStart.y||Math.floor(t.maxY)===Math.floor(t.startY)&&t.touchesCurrent.y>t.touchesStart.y)){t.isTouched=!1,P();return}}i.cancelable&&i.preventDefault(),i.stopPropagation(),de(),t.isMoved=!0;const d=(o.scale-u)/(e.maxRatio-a.params.zoom.minRatio),{originX:h,originY:m}=e;t.currentX=t.touchesCurrent.x-t.touchesStart.x+t.startX+d*(t.width-h*2),t.currentY=t.touchesCurrent.y-t.touchesStart.y+t.startY+d*(t.height-m*2),t.currentX<t.minX&&(t.currentX=t.minX+1-(t.minX-t.currentX+1)**.8),t.currentX>t.maxX&&(t.currentX=t.maxX-1+(t.currentX-t.maxX+1)**.8),t.currentY<t.minY&&(t.currentY=t.minY+1-(t.minY-t.currentY+1)**.8),t.currentY>t.maxY&&(t.currentY=t.maxY-1+(t.currentY-t.maxY+1)**.8),l.prevPositionX||(l.prevPositionX=t.touchesCurrent.x),l.prevPositionY||(l.prevPositionY=t.touchesCurrent.y),l.prevTime||(l.prevTime=Date.now()),l.x=(t.touchesCurrent.x-l.prevPositionX)/(Date.now()-l.prevTime)/2,l.y=(t.touchesCurrent.y-l.prevPositionY)/(Date.now()-l.prevTime)/2,Math.abs(t.touchesCurrent.x-l.prevPositionX)<2&&(l.x=0),Math.abs(t.touchesCurrent.y-l.prevPositionY)<2&&(l.y=0),l.prevPositionX=t.touchesCurrent.x,l.prevPositionY=t.touchesCurrent.y,l.prevTime=Date.now(),e.imageWrapEl.style.transform=`translate3d(${t.currentX}px, ${t.currentY}px,0)`}function pe(){const i=a.zoom;if(r.length=0,!e.imageEl)return;if(!t.isTouched||!t.isMoved){t.isTouched=!1,t.isMoved=!1;return}t.isTouched=!1,t.isMoved=!1;let s=300,n=300;const o=l.x*s,c=t.currentX+o,p=l.y*n,g=t.currentY+p;l.x!==0&&(s=Math.abs((c-t.currentX)/l.x)),l.y!==0&&(n=Math.abs((g-t.currentY)/l.y));const d=Math.max(s,n);t.currentX=c,t.currentY=g;const h=t.width*i.scale,m=t.height*i.scale;t.minX=Math.min(e.slideWidth/2-h/2,0),t.maxX=-t.minX,t.minY=Math.min(e.slideHeight/2-m/2,0),t.maxY=-t.minY,t.currentX=Math.max(Math.min(t.currentX,t.maxX),t.minX),t.currentY=Math.max(Math.min(t.currentY,t.maxY),t.minY),e.imageWrapEl.style.transitionDuration=`${d}ms`,e.imageWrapEl.style.transform=`translate3d(${t.currentX}px, ${t.currentY}px,0)`}function K(){const i=a.zoom;e.slideEl&&a.activeIndex!==a.slides.indexOf(e.slideEl)&&(e.imageEl&&(e.imageEl.style.transform="translate3d(0,0,0) scale(1)"),e.imageWrapEl&&(e.imageWrapEl.style.transform="translate3d(0,0,0)"),e.slideEl.classList.remove(`${a.params.zoom.zoomedSlideClass}`),i.scale=1,u=1,e.slideEl=void 0,e.imageEl=void 0,e.imageWrapEl=void 0,e.originX=0,e.originY=0)}function N(i){if(u<=1||!e.imageWrapEl||!X(i)||!j(i))return;const s=x.getComputedStyle(e.imageWrapEl).transform,n=new x.DOMMatrix(s);if(!C){C=!0,v.x=i.clientX,v.y=i.clientY,t.startX=n.e,t.startY=n.f,t.width=e.imageEl.offsetWidth||e.imageEl.clientWidth,t.height=e.imageEl.offsetHeight||e.imageEl.clientHeight,e.slideWidth=e.slideEl.offsetWidth,e.slideHeight=e.slideEl.offsetHeight;return}const o=(i.clientX-v.x)*q,c=(i.clientY-v.y)*q,p=t.width*u,g=t.height*u,d=e.slideWidth,h=e.slideHeight,m=Math.min(d/2-p/2,0),f=-m,Y=Math.min(h/2-g/2,0),T=-Y,M=Math.max(Math.min(t.startX+o,f),m),y=Math.max(Math.min(t.startY+c,T),Y);e.imageWrapEl.style.transitionDuration="0ms",e.imageWrapEl.style.transform=`translate3d(${M}px, ${y}px, 0)`,v.x=i.clientX,v.y=i.clientY,t.startX=M,t.startY=y}function Q(i){const s=a.zoom,n=a.params.zoom;if(!e.slideEl){i&&i.target&&(e.slideEl=i.target.closest(`.${a.params.slideClass}, swiper-slide`)),e.slideEl||(a.params.virtual&&a.params.virtual.enabled&&a.virtual?e.slideEl=ne(a.slidesEl,`.${a.params.slideActiveClass}`)[0]:e.slideEl=a.slides[a.activeIndex]);let W=e.slideEl.querySelector(`.${n.containerClass}`);W&&(W=W.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),e.imageEl=W,W?e.imageWrapEl=A(e.imageEl,`.${n.containerClass}`)[0]:e.imageWrapEl=void 0}if(!e.imageEl||!e.imageWrapEl)return;a.params.cssMode&&(a.wrapperEl.style.overflow="hidden",a.wrapperEl.style.touchAction="none"),e.slideEl.classList.add(`${n.zoomedSlideClass}`);let o,c,p,g,d,h,m,f,Y,T,M,y,b,$,L,R,I,O;typeof t.touchesStart.x>"u"&&i?(o=i.pageX,c=i.pageY):(o=t.touchesStart.x,c=t.touchesStart.y);const z=typeof i=="number"?i:null;u===1&&z&&(o=void 0,c=void 0,t.touchesStart.x=void 0,t.touchesStart.y=void 0);const ae=Z();s.scale=z||ae,u=z||ae,i&&!(u===1&&z)?(I=e.slideEl.offsetWidth,O=e.slideEl.offsetHeight,p=se(e.slideEl).left+x.scrollX,g=se(e.slideEl).top+x.scrollY,d=p+I/2-o,h=g+O/2-c,Y=e.imageEl.offsetWidth||e.imageEl.clientWidth,T=e.imageEl.offsetHeight||e.imageEl.clientHeight,M=Y*s.scale,y=T*s.scale,b=Math.min(I/2-M/2,0),$=Math.min(O/2-y/2,0),L=-b,R=-$,m=d*s.scale,f=h*s.scale,m<b&&(m=b),m>L&&(m=L),f<$&&(f=$),f>R&&(f=R)):(m=0,f=0),z&&s.scale===1&&(e.originX=0,e.originY=0),e.imageWrapEl.style.transitionDuration="300ms",e.imageWrapEl.style.transform=`translate3d(${m}px, ${f}px,0)`,e.imageEl.style.transitionDuration="300ms",e.imageEl.style.transform=`translate3d(0,0,0) scale(${s.scale})`}function U(){const i=a.zoom,s=a.params.zoom;if(!e.slideEl){a.params.virtual&&a.params.virtual.enabled&&a.virtual?e.slideEl=ne(a.slidesEl,`.${a.params.slideActiveClass}`)[0]:e.slideEl=a.slides[a.activeIndex];let n=e.slideEl.querySelector(`.${s.containerClass}`);n&&(n=n.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),e.imageEl=n,n?e.imageWrapEl=A(e.imageEl,`.${s.containerClass}`)[0]:e.imageWrapEl=void 0}!e.imageEl||!e.imageWrapEl||(a.params.cssMode&&(a.wrapperEl.style.overflow="",a.wrapperEl.style.touchAction=""),i.scale=1,u=1,t.touchesStart.x=void 0,t.touchesStart.y=void 0,e.imageWrapEl.style.transitionDuration="300ms",e.imageWrapEl.style.transform="translate3d(0,0,0)",e.imageEl.style.transitionDuration="300ms",e.imageEl.style.transform="translate3d(0,0,0) scale(1)",e.slideEl.classList.remove(`${s.zoomedSlideClass}`),e.slideEl=void 0,e.originX=0,e.originY=0,a.params.zoom.panOnMouseMove&&(v={x:0,y:0},C&&(C=!1,t.startX=0,t.startY=0)))}function V(i){const s=a.zoom;s.scale&&s.scale!==1?U():Q(i)}function ee(){const i=a.params.passiveListeners?{passive:!0,capture:!1}:!1,s=a.params.passiveListeners?{passive:!1,capture:!0}:!0;return{passiveListener:i,activeListenerWithCapture:s}}function te(){const i=a.zoom;if(i.enabled)return;i.enabled=!0;const{passiveListener:s,activeListenerWithCapture:n}=ee();a.wrapperEl.addEventListener("pointerdown",k,s),a.wrapperEl.addEventListener("pointermove",_,n),["pointerup","pointercancel","pointerout"].forEach(o=>{a.wrapperEl.addEventListener(o,B,s)}),a.wrapperEl.addEventListener("pointermove",J,n)}function ie(){const i=a.zoom;if(!i.enabled)return;i.enabled=!1;const{passiveListener:s,activeListenerWithCapture:n}=ee();a.wrapperEl.removeEventListener("pointerdown",k,s),a.wrapperEl.removeEventListener("pointermove",_,n),["pointerup","pointercancel","pointerout"].forEach(o=>{a.wrapperEl.removeEventListener(o,B,s)}),a.wrapperEl.removeEventListener("pointermove",J,n)}E("init",()=>{a.params.zoom.enabled&&te()}),E("destroy",()=>{ie()}),E("touchStart",(i,s)=>{a.zoom.enabled&&fe(s)}),E("touchEnd",(i,s)=>{a.zoom.enabled&&pe()}),E("doubleTap",(i,s)=>{!a.animating&&a.params.zoom.enabled&&a.zoom.enabled&&a.params.zoom.toggle&&V(s)}),E("transitionEnd",()=>{a.zoom.enabled&&a.params.zoom.enabled&&K()}),E("slideChange",()=>{a.zoom.enabled&&a.params.zoom.enabled&&a.params.cssMode&&K()}),Object.assign(a.zoom,{enable:te,disable:ie,in:Q,out:U,toggle:V})}export{Ee as Z};
