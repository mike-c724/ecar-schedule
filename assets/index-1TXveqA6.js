import{_ as se,r as R,v as ae,b as re,o as C,c as y,e as _,F as q,C as J,f as ie,w as K,i as M,u as le,D as Q,G as oe,H as ne,x as L,l as ce,h as de,m as ue,t as fe}from"./index-Bz8aCySx.js";import{S as pe,a as he}from"./swiper-vue-Cu1ZKMQW.js";import{g as ve,s as me,e as ge,c as W}from"./swiper-LA7WfxAj.js";import{N as we}from"./navigation-CAGu2O-O.js";import{Z as Se}from"./zoom-Ca8q2gD7.js";/* empty css                   *//* empty css                   *//* empty css             */function _e(F){let{swiper:e,extendParams:d,on:p,emit:h}=F;d({virtual:{enabled:!1,slides:[],cache:!0,renderSlide:null,renderExternal:null,renderExternalUpdate:!0,addSlidesBefore:0,addSlidesAfter:0}});let T;const P=ve();e.virtual={cache:{},from:void 0,to:void 0,slides:[],offset:0,slidesGrid:[]};const w=P.createElement("div");function v(t,r){const s=e.params.virtual;if(s.cache&&e.virtual.cache[r])return e.virtual.cache[r];let a;return s.renderSlide?(a=s.renderSlide.call(e,t,r),typeof a=="string"&&(w.innerHTML=a,a=w.children[0])):e.isElement?a=W("swiper-slide"):a=W("div",e.params.slideClass),a.setAttribute("data-swiper-slide-index",r),s.renderSlide||(a.innerHTML=t),s.cache&&(e.virtual.cache[r]=a),a}function S(t,r,s){const{slidesPerView:a,slidesPerGroup:l,centeredSlides:u,loop:o,initialSlide:c}=e.params;if(r&&!o&&c>0)return;const{addSlidesBefore:f,addSlidesAfter:O}=e.params.virtual,{from:k,to:$,slides:m,slidesGrid:X,offset:Y}=e.virtual;e.params.cssMode||e.updateActiveIndex();const G=typeof s>"u"?e.activeIndex||0:s;let N;e.rtlTranslate?N="right":N=e.isHorizontal()?"left":"top";let B,b;u?(B=Math.floor(a/2)+l+O,b=Math.floor(a/2)+l+f):(B=a+(l-1)+O,b=(o?a:l)+f);let g=G-b,x=G+B;o||(g=Math.max(g,0),x=Math.min(x,m.length-1));let I=(e.slidesGrid[g]||0)-(e.slidesGrid[0]||0);o&&G>=b?(g-=b,u||(I+=e.slidesGrid[0])):o&&G<b&&(g=-b,u&&(I+=e.slidesGrid[0])),Object.assign(e.virtual,{from:g,to:x,offset:I,slidesGrid:e.slidesGrid,slidesBefore:b,slidesAfter:B});function H(){e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),h("virtualUpdate")}if(k===g&&$===x&&!t){e.slidesGrid!==X&&I!==Y&&e.slides.forEach(i=>{i.style[N]=`${I-Math.abs(e.cssOverflowAdjustment())}px`}),e.updateProgress(),h("virtualUpdate");return}if(e.params.virtual.renderExternal){e.params.virtual.renderExternal.call(e,{offset:I,from:g,to:x,slides:function(){const n=[];for(let E=g;E<=x;E+=1)n.push(m[E]);return n}()}),e.params.virtual.renderExternalUpdate?H():h("virtualUpdate");return}const A=[],U=[],Z=i=>{let n=i;return i<0?n=m.length+i:n>=m.length&&(n=n-m.length),n};if(t)e.slides.filter(i=>i.matches(`.${e.params.slideClass}, swiper-slide`)).forEach(i=>{i.remove()});else for(let i=k;i<=$;i+=1)if(i<g||i>x){const n=Z(i);e.slides.filter(E=>E.matches(`.${e.params.slideClass}[data-swiper-slide-index="${n}"], swiper-slide[data-swiper-slide-index="${n}"]`)).forEach(E=>{E.remove()})}const ee=o?-m.length:0,te=o?m.length*2:m.length;for(let i=ee;i<te;i+=1)if(i>=g&&i<=x){const n=Z(i);typeof $>"u"||t?U.push(n):(i>$&&U.push(n),i<k&&A.push(n))}if(U.forEach(i=>{e.slidesEl.append(v(m[i],i))}),o)for(let i=A.length-1;i>=0;i-=1){const n=A[i];e.slidesEl.prepend(v(m[n],n))}else A.sort((i,n)=>n-i),A.forEach(i=>{e.slidesEl.prepend(v(m[i],i))});ge(e.slidesEl,".swiper-slide, swiper-slide").forEach(i=>{i.style[N]=`${I-Math.abs(e.cssOverflowAdjustment())}px`}),H()}function j(t){if(typeof t=="object"&&"length"in t)for(let r=0;r<t.length;r+=1)t[r]&&e.virtual.slides.push(t[r]);else e.virtual.slides.push(t);S(!0)}function z(t){const r=e.activeIndex;let s=r+1,a=1;if(Array.isArray(t)){for(let l=0;l<t.length;l+=1)t[l]&&e.virtual.slides.unshift(t[l]);s=r+t.length,a=t.length}else e.virtual.slides.unshift(t);if(e.params.virtual.cache){const l=e.virtual.cache,u={};Object.keys(l).forEach(o=>{const c=l[o],f=c.getAttribute("data-swiper-slide-index");f&&c.setAttribute("data-swiper-slide-index",parseInt(f,10)+a),u[parseInt(o,10)+a]=c}),e.virtual.cache=u}S(!0),e.slideTo(s,0)}function V(t){if(typeof t>"u"||t===null)return;let r=e.activeIndex;if(Array.isArray(t))for(let s=t.length-1;s>=0;s-=1)e.params.virtual.cache&&(delete e.virtual.cache[t[s]],Object.keys(e.virtual.cache).forEach(a=>{a>t&&(e.virtual.cache[a-1]=e.virtual.cache[a],e.virtual.cache[a-1].setAttribute("data-swiper-slide-index",a-1),delete e.virtual.cache[a])})),e.virtual.slides.splice(t[s],1),t[s]<r&&(r-=1),r=Math.max(r,0);else e.params.virtual.cache&&(delete e.virtual.cache[t],Object.keys(e.virtual.cache).forEach(s=>{s>t&&(e.virtual.cache[s-1]=e.virtual.cache[s],e.virtual.cache[s-1].setAttribute("data-swiper-slide-index",s-1),delete e.virtual.cache[s])})),e.virtual.slides.splice(t,1),t<r&&(r-=1),r=Math.max(r,0);S(!0),e.slideTo(r,0)}function D(){e.virtual.slides=[],e.params.virtual.cache&&(e.virtual.cache={}),S(!0),e.slideTo(0,0)}p("beforeInit",()=>{if(!e.params.virtual.enabled)return;let t;if(typeof e.passedParams.virtual.slides>"u"){const r=[...e.slidesEl.children].filter(s=>s.matches(`.${e.params.slideClass}, swiper-slide`));r.length&&(e.virtual.slides=[...r],t=!0,r.forEach((s,a)=>{s.setAttribute("data-swiper-slide-index",a),e.virtual.cache[a]=s,s.remove()}))}t||(e.virtual.slides=e.params.virtual.slides),e.classNames.push(`${e.params.containerModifierClass}virtual`),e.params.watchSlidesProgress=!0,e.originalParams.watchSlidesProgress=!0,S(!1,!0)}),p("setTranslate",()=>{e.params.virtual.enabled&&(e.params.cssMode&&!e._immediateVirtual?(clearTimeout(T),T=setTimeout(()=>{S()},100)):S())}),p("init update resize",()=>{e.params.virtual.enabled&&e.params.cssMode&&me(e.wrapperEl,"--swiper-virtual-size",`${e.virtualSize}px`)}),Object.assign(e.virtual,{appendSlide:j,prependSlide:z,removeSlide:V,removeAllSlides:D,update:S})}const be={class:"photo-container"},xe={class:"photo-tabs-wrapper"},Ie=["onClick"],Ee={class:"photo-viewer"},Te={class:"photo-slide"},Pe={class:"photo-img"},Ce={class:"swiper-zoom-container"},Ae=["src","alt"],ye={class:"photo-info"},Me={class:"photo-name"},Le={class:"photo-name-index"},Oe={key:0,class:"photo-assessment"},$e={__name:"index",setup(F){const e=le(),d=R([]),p=R(0),h=R(null),{proxy:T}=fe(),P=R(null),w=ae(()=>d.value.reduce((t,r)=>t.concat(r.structurePhotoList),[])),v=t=>{Q(()=>{if(P.value){const r=P.value.querySelectorAll(".tab-item");if(r[t]){const s=r[t],a=P.value,l=a.getBoundingClientRect(),u=s.getBoundingClientRect(),o=s.offsetLeft-l.width/2+u.width/2;a.scrollTo({left:o,behavior:"smooth"})}}})},S=t=>{var s;p.value=t;const r=d.value.slice(0,t).reduce((a,l)=>a+l.structurePhotoList.length,0);(s=h.value)==null||s.slideTo(r),v(t)},j=()=>{if(!h.value)return;const t=h.value.activeIndex;let r=0;for(let s=0;s<d.value.length;s++)if(r+=d.value[s].structurePhotoList.length,t<r){if(p.value!==s&&(p.value=s,v(s)),t+1<w.value.length){const a=new Image;a.src=w.value[t+1].photoOriginal}break}},z=t=>{if(h.value=t,w.value.length>0){const r=a=>{a.forEach(l=>{if(l>=0&&l<w.value.length){const u=new Image;u.src=w.value[l].photoOriginal}})},s=t.activeIndex;r([s-1,s+1])}},V=()=>{const t=e.params.structure,r=e.params.partsId,s=e.params.orderPhotoId;if(d.value.length&&t){const a=d.value.findIndex(l=>l.photoStructure===t);if(a!==-1){p.value=a,v(a);const l=d.value[a].structurePhotoList;if(s){const o=w.value.findIndex(c=>c.orderPhotoId===s);if(o!==-1){setTimeout(()=>{var c;(c=h.value)==null||c.slideTo(o,0),v(a)},100);return}}if(r){const o=d.value.slice(0,a).reduce((f,O)=>f+O.structurePhotoList.length,0),c=l.findIndex(f=>f.partsId===r);if(c!==-1){setTimeout(()=>{var f;(f=h.value)==null||f.slideTo(o+c,0),v(a)},100);return}}const u=d.value.slice(0,a).reduce((o,c)=>o+c.structurePhotoList.length,0);setTimeout(()=>{var o;(o=h.value)==null||o.slideTo(u,0),v(a)},100)}}},D=async()=>{T.$modal.loading("正在加载数据，请稍候...");const t=e.params.orderId;try{const{data:r}=await oe(t);d.value=r,T.$modal.loading("正在加载"),Q(()=>{V()})}catch(r){console.error("获取照片失败:",r)}T.$modal.closeLoading()};return re(()=>{D(),window.addEventListener("resize",()=>{p.value!==null&&v(p.value)})}),(t,r)=>(C(),y("div",be,[_("div",xe,[_("div",{class:"photo-tabs",ref_key:"tabsRef",ref:P},[(C(!0),y(q,null,J(d.value,(s,a)=>(C(),y("div",{key:a,class:ne(["tab-item",{active:p.value===a}]),onClick:l=>S(a)},L(s.photoTypeDesc)+" ("+L(s.photoCount)+") ",11,Ie))),128))],512)]),_("div",Ee,[ie(M(pe),{modules:[M(we),M(_e),M(Se)],"slides-per-view":1,"space-between":10,navigation:!0,pagination:{type:"fraction"},virtual:{enabled:!0,cache:!0,addSlidesBefore:1,addSlidesAfter:1},zoom:!0,onSwiper:z,onSlideChange:j,class:"photo-swiper"},{default:K(()=>[(C(!0),y(q,null,J(w.value,(s,a)=>(C(),ce(M(he),{key:a,"virtual-index":a},{default:K(()=>[_("div",Te,[_("div",Pe,[_("div",Ce,[_("img",{src:s.photoOriginal,alt:s.photoName,class:"fullscreen-img"},null,8,Ae)])]),_("div",ye,[_("span",Me,[de(L(s.photoName)+" ",1),_("span",Le,L(s.photoIndex),1)]),s.assessmentNameStr?(C(),y("span",Oe,L(s.assessmentNameStr),1)):ue("",!0)])])]),_:2},1032,["virtual-index"]))),128))]),_:1},8,["modules"])])]))}},ke=se($e,[["__scopeId","data-v-ffea78d7"]]);export{ke as default};
