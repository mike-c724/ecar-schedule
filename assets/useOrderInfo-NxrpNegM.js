import{aM as D,r as o,aN as G,aO as b,aP as U,aQ as W,aR as E,aS as A,aT as L,aU as H,aV as O,aW as N,aX as _,b as $,u as F,aY as M,aZ as x}from"./index-CBERRbij.js";const k=async e=>{try{const{data:a,code:s}=await D(e);return a&&s===200?(ie(a),!0):(console.error(`Error fetching base order info: ${s}`),!1)}catch(a){return console.error("Error occurred while fetching base order info:",a),!1}};o({});const S=async()=>{try{const{data:e,code:a}=await b(c.value);return e&&a===200?(ve(e),!0):(console.error(`Error fetching standard photo info: ${a}`),!1)}catch(e){return console.error("Error occurred while fetching standard photo info:",e),!1}},Y=e=>e&&{...e,rejectedItem:{...e.rejectedItem,rejectedItem:f.value,rejectedRemark:I.value}},Be=async e=>{let a={...m.value,standardPhoto:Y(m.value.standardPhoto)};return await G(a),await S(c.value)?{col:e,code:200}:{col:e,code:500}},R=async(e,a)=>{try{console.log("Fetching chassis info...",c.value),console.log("tabType",a);const{code:s,data:t}=await A(c.value);return t&&s===200?(a=="ecoChassis"&&t.push({groupName:"新能源底盘",row:"ecoChassis",column:"ecoChassis",detectionType:"common_detection",type:"ecoChassis"}),he(t,a),console.log("Chassis Info:",t),!0):(console.error(`Error fetching ba  e order info: ${s}`),!1)}catch(s){return console.error("Error fetching chassis info:",s),!1}},Q=async e=>{try{let a=null,s=e;e.type&&e.type=="ecoChassis"?(s=c.value,a=U):a=W;const{code:t,data:r}=await a(s);return r&&t===200?(e.type&&e.type=="ecoChassis"&&(r.type=e.type),pe(0),fe(r),r):(console.error(`Error fetching chassis part info: ${t}`),!1)}catch(a){return console.error("Error fetching chassis part info:",a),!1}},Re=async e=>{var a,s,t,r,l;if(console.log("handleSaveChassisPart",(a=n.value)==null?void 0:a.type),(s=n.value)!=null&&s.type&&n.value.type=="ecoChassis")return!0;{let u={orderId:c.value,orderDetectionRejectedItemId:w.value,detectionType:((t=n.value)==null?void 0:t.detectionType)||null,planColumn:((r=n.value)==null?void 0:r.column)||null,planRow:((l=n.value)==null?void 0:l.row)||null,rejectedItem:f.value,rejectedRemark:I.value};return await E(u)}},q=async e=>await L(e),z=async(e,a="navbarOperate")=>{const s=await H(e);return me(s.data,a),s},J=async e=>{try{const{code:a,data:s}=await O(e);return s&&a===200?(Ce(0),ge(s),s):(console.error(`Error fetching BodyWorkGroupDatainfo: ${a}`),!1)}catch(a){return console.error("Error fetching BodyWorkGroupData info:",a),!1}finally{}},Ee=async e=>{try{const{code:a}=await E(e);return a===200?!0:(console.error(`Error fetching BodyWorkGroupDatainfo: ${a}`),!1)}catch(a){console.error("Error fetchingBodyWorkGroupData info:",a)}},K=async e=>{const a=await _(e);return Pe(a.data),a},ke=async e=>{try{const{code:a}=await N(e);return a===200}catch{}return!1},c=o(null),X=o({}),Se=o(null),i=o({}),Z=o("orderBase"),v=o(null),V=o([]),ee=o([]),ae=o([]),se=o(null),p=o([]),m=o(null),n=o(null),g=o([]),d=o([]),T=o(null),P=o(0),w=o(null),oe=o([]),te=o(null),y=o([]),B=o(0),re=o(null),f=o([]),I=o(""),ne=o([{label:"基础信息",name:"orderBase",value:"STRUCTURE_0"},{label:"标准照片",name:"orderStandard",value:"STRUCTURE_1"},{label:"车身",name:"orderBodyWork",value:"STRUCTURE_2"},{label:"底盘",name:"orderChassis",value:"STRUCTURE_3"},{label:"新能源底盘",name:"ecoChassis",value:"STRUCTURE_5"},{label:"动力电池数据",name:"powerBatteryPanel",value:"STRUCTURE_6"},{label:"定损信息",name:"vehicleDamageInfo",value:"STRUCTURE_7"},{label:"复勘信息",name:"recheckInfo",value:"STRUCTURE_8"}]),C=o([]),h=e=>{f.value=(e==null?void 0:e.rejectedItem)||[],I.value=(e==null?void 0:e.rejectedRemark)||""},ce=()=>f.value&&f.value.length>0||I.value!=="",Te=()=>{$(async()=>{const e=F();c.value=e.params.id;const a=M.service({lock:!0,text:"加载中...",background:"rgba(0, 0, 0, 0.7)"});try{await le(),await k(c.value)}catch(s){console.error("初始化订单信息失败:",s)}finally{a.close()}})},le=async()=>{try{const e=await x(c.value);e.code===200&&(C.value=ne.value.filter(a=>e.data.includes(a.value)),C.value.length>0&&(Z.value=C.value[0].name,ue()))}catch(e){console.error("获取订单评测类型失败:",e)}},ue=()=>{T.value={},n.value={},d.value=[],g.value=[]},je=async e=>{console.log("getEvaluatedDataBYSelectedTab",e);try{switch(e){case"orderBase":return await k(c.value);case"orderStandard":return await S(c.value);case"orderChassis":return await R(c.value);case"ecoChassis":return await R(c.value,"ecoChassis");case"orderBodyWork":return await z(c.value);case"powerBatteryPanel":return await K(c.value);default:return null}}catch(a){return console.error(`获取${e}数据失败:`,a),null}},De=e=>{var a;v.value&&v.value.orderPhotoId&&((a=i.value.orderBasePhoto)==null||a.forEach(s=>{s.orderPhotoId===v.value.orderPhotoId&&(s.rejectedItem={...s.rejectedItem,rejectedItem:f.value,rejectedRemark:I.value})})),v.value=null,v.value=e,h(e.rejectedItem)},ie=e=>{if(v.value=null,X.value=e,i.value=e,e.orderBasePhoto&&e.orderBasePhoto.length>0){const a=e.orderBasePhoto[0];v.value=a,h(a==null?void 0:a.rejectedItem)}p.value=[...e.drivingLicenseDisplayFields||[],...e.registrationInfoDisplayFields||[],...e.otherInfoDisplayFields||[]].map(a=>a.dictValue),de()},de=()=>{var e,a,s,t,r,l;ee.value=((a=(e=i.value.drivingLicenseInfo)==null?void 0:e.elementRejectedItem)==null?void 0:a.map(u=>u.elementName))||[],ae.value=((t=(s=i.value.registrationCertificateInfo)==null?void 0:s.elementRejectedItem)==null?void 0:t.map(u=>u.elementName))||[],V.value=((l=(r=i.value.othersInfo)==null?void 0:r.elementRejectedItem)==null?void 0:l.map(u=>u.elementName))||[]},Ge=e=>!e||e.length===0?[]:e.filter(a=>a.value==="brand"||a.value==="carSeries"||a.value==="models"?p.value.some(s=>s==="carSeries"):a.value==="placeOfBelongRegion"||a.value==="placeOfBelongProvince"?p.value.some(s=>s==="placeOfBelongProvince"):p.value.some(s=>s===a.value)),ve=e=>{var a;if(i.value=e,e&&e.length>0){const s=e[0];m.value=s,h((a=s==null?void 0:s.standardPhoto)==null?void 0:a.rejectedItem)}},be=e=>{var s;if(!e)return;const a=i.value.find(t=>t.standardPhoto.orderPhotoId===e.standardPhoto.orderPhotoId);a&&(m.value=a,h((s=a==null?void 0:a.standardPhoto)==null?void 0:s.rejectedItem))},he=(e,a)=>{var s,t,r;if(n.value=null,i.value=e,e&&e.length>0&&e[0].chassisPhotoList&&e[0].chassisPhotoList.length>0){n.value=e[0].chassisPhotoList[0];const l={orderId:c.value,detectionType:((s=n.value)==null?void 0:s.detectionType)||null,planColumn:((t=n.value)==null?void 0:t.column)||null,planRow:((r=n.value)==null?void 0:r.row)||null};Q(l)}},fe=e=>{var a;e.type=="ecoChassis"?(Ie(e),d.value=[{photoOriginal:e.chassisMergePhoto,type:"ecoChassis"}],g.value=[],w.value=null,h(e==null?void 0:e.rejectedItem)):(d.value=e.assessmentPhotoList||[],g.value=e.assessmentInfoList||[],w.value=((a=e==null?void 0:e.rejectedItem)==null?void 0:a.orderDetectionRejectedItemId)||null,h(e==null?void 0:e.rejectedItem))},Ie=e=>{T.value=e},Ue=e=>{var a;(a=i.value)==null||a.forEach(s=>{var t;(t=s==null?void 0:s.chassisPhotoList)==null||t.forEach(r=>{r.detectionType===n.value.detectionType&&r.column===n.value.column&&r.row===n.value.row&&(r.isReject=ce())})}),n.value=null,n.value=e},pe=e=>{P.value=e},We=e=>{d.value.length>P.value&&(d.value[P.value].assessmentSelectInfoList=e)},ye=o([]),Ae=o(null),Le=async e=>{const{code:a,data:s}=await q(e);se.value=s.chassisPoint,g.value=s.assessmentInfoList,d.value[0].assessmentSelectInfoList=s.assessmentSelectInfoList,d.value=[...d.value],ye.value=s,n.value.isRejected=s==null?void 0:s.isRejected,n.value.orderBearingDetectionEvaluationId=s==null?void 0:s.orderBearingDetectionEvaluationId,n.value.partsId=s.partsId},me=(e,a)=>{if(oe.value=e,a==="navbarOperate"&&e&&e.length>0){const t=e[0].partsList;if(t&&t.length>0){const r=t[0].assessmentGroupList;if(r&&r.length>0){const l=r[0].detectionType||"",u=r[0].partsId;te.value=`${u}-${l}`;const j={detectionType:l,orderId:c.value,partsId:u};J(j)}}}},ge=e=>{y.value=e,h(e.rejectedItem)},Ce=e=>{B.value=e},He=e=>{var a;(a=y.value)!=null&&a.assessmentPhotoList&&y.value.assessmentPhotoList.length>B.value&&(y.value.assessmentPhotoList[B.value].assessmentSelectInfoList=e)},Pe=e=>{re.value=e||{}},Oe=o({}),Ne=o({});export{Le as A,He as B,g as C,We as D,re as E,Se as F,ke as G,Ne as H,m as I,Be as J,be as K,Oe as L,Te as M,Z as N,C as O,Ge as P,ee as Q,ae as R,V as S,je as T,v as a,De as b,oe as c,te as d,y as e,k as f,B as g,Ce as h,c as i,I as j,Ee as k,z as l,J as m,n,X as o,d as p,P as q,f as r,i as s,pe as t,Re as u,se as v,Ae as w,Ue as x,Q as y,T as z};
