import{_ as U,r as u,aD as z,A,g as n,o as p,l as _,w as t,f as l,h as g,c as D,i as h,aE as I,aF as J,am as a,aG as R}from"./index-Bz8aCySx.js";const T=["src"],j={__name:"buildOrder",emits:["create"],setup(F,{expose:P,emit:b}){const m=b,i=u(!1),k=u("/prod-api/order/common/up-photo"),x={Authorization:"Bearer "+z()},r=u(!1),s=u(!1),y=u(),o=A({contentPhoto:{}}),C={},B=(e,c)=>{r.value=!1,e.code===200&&e.data?(o.contentPhoto=e.data,a.success("上传成功")):a.error(e.msg||"上传失败")},w=e=>{r.value=!0;const c=e.type==="image/jpeg"||e.type==="image/png",f=e.size/1024/1024<10;return c?f?!0:(r.value=!1,a.error("上传图片大小不能超过 10MB!"),!1):(r.value=!1,a.error("上传图片只能是 JPG 或 PNG 格式!"),!1)},d=()=>{o.contentPhoto={},i.value=!1,s.value=!1},O=()=>{o.contentPhoto={},i.value=!0,s.value=!1},V=()=>{if(!o.contentPhoto){a.error("请上传行驶证照片");return}s.value=!0,R(o.contentPhoto).then(e=>{e.code===200?(a.success("创建成功"),d(),m("create")):(a.error(e.msg),s.value=!1,m("create"))}).catch(e=>{a.error(e.msg||"创建失败"),s.value=!1})};return P({open:O,close:d}),(e,c)=>{const f=n("el-icon"),G=n("el-upload"),E=n("el-form-item"),L=n("el-form"),v=n("el-button"),M=n("el-dialog");return p(),_(M,{modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=N=>i.value=N),title:"保前建单",width:"520px",onClose:d},{footer:t(()=>[l(v,{onClick:d},{default:t(()=>[g("取消")]),_:1}),l(v,{type:"primary",loading:s.value,onClick:V},{default:t(()=>[g("创建")]),_:1},8,["loading"])]),default:t(()=>[l(L,{model:o,rules:C,ref_key:"formRef",ref:y,"label-width":"100px"},{default:t(()=>[l(E,{label:"行驶证照片",prop:"contentPhoto"},{default:t(()=>[l(G,{class:"cover-uploader",action:k.value,headers:x,"show-file-list":!1,"on-success":B,"before-upload":w},{default:t(()=>[o.contentPhoto&&o.contentPhoto.photoOriginal?(p(),D("img",{key:0,src:o.contentPhoto.photoOriginal,class:"cover-image"},null,8,T)):r.value?(p(),_(f,{key:2,class:"cover-uploader-icon is-loading"},{default:t(()=>[l(h(J))]),_:1})):(p(),_(f,{key:1,class:"cover-uploader-icon"},{default:t(()=>[l(h(I))]),_:1}))]),_:1},8,["action"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},q=U(j,[["__scopeId","data-v-752fbc7c"]]);export{q as default};
